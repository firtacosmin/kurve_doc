unit FLER2;

interface

uses
  Windows, Messages, SysUtils, Classes, Graphics, Controls, Forms, Dialogs,
  StdCtrls, DBCtrls, ExtCtrls, ComCtrls, Tabnotbk, Menus, Math, ExtDlgs,
  FileCtrl;

type
  TForm4 = class(TForm)
    TabbedNotebook1: TTabbedNotebook;
    Button5: TButton;
    Button6: TButton;
    Button7: TButton;
    Button8: TButton;
    OpenPictureDialog1: TOpenPictureDialog;
    FileListBox1: TFileListBox;
    panel1: TPanel;
    Button1: TButton;
    Button2: TButton;
    Button4: TButton;
    Panel2: TPanel;
    Label2: TLabel;
    Label3: TLabel;
    Label4: TLabel;
    Label5: TLabel;
    Label6: TLabel;
    Label7: TLabel;
    Label8: TLabel;
    Label9: TLabel;
    Label10: TLabel;
    Label11: TLabel;
    Label12: TLabel;
    Label13: TLabel;
    Label1: TLabel;
    ComboBox13: TComboBox;
    ComboBox12: TComboBox;
    ComboBox11: TComboBox;
    ComboBox10: TComboBox;
    ComboBox9: TComboBox;
    ComboBox8: TComboBox;
    ComboBox7: TComboBox;
    ComboBox6: TComboBox;
    ComboBox5: TComboBox;
    ComboBox4: TComboBox;
    ComboBox3: TComboBox;
    ComboBox2: TComboBox;
    ComboBox1: TComboBox;
    Label62: TLabel;
    Panel3: TPanel;
    Label14: TLabel;
    Label15: TLabel;
    Label16: TLabel;
    Label17: TLabel;
    Label18: TLabel;
    Label19: TLabel;
    Label20: TLabel;
    Label21: TLabel;
    Label22: TLabel;
    Label23: TLabel;
    Label24: TLabel;
    Label25: TLabel;
    Label38: TLabel;
    Label57: TLabel;
    Edit12: TEdit;
    Edit11: TEdit;
    Edit10: TEdit;
    Edit9: TEdit;
    Edit8: TEdit;
    Edit7: TEdit;
    Edit6: TEdit;
    Edit5: TEdit;
    Edit4: TEdit;
    Edit3: TEdit;
    Edit2: TEdit;
    Edit1: TEdit;
    Panel4: TPanel;
    Label26: TLabel;
    Label27: TLabel;
    Label28: TLabel;
    Label29: TLabel;
    Label30: TLabel;
    Label31: TLabel;
    Label32: TLabel;
    Label33: TLabel;
    Label34: TLabel;
    Label35: TLabel;
    Label36: TLabel;
    Label37: TLabel;
    Label39: TLabel;
    Label60: TLabel;
    Edit24: TEdit;
    Edit23: TEdit;
    Edit22: TEdit;
    Edit21: TEdit;
    Edit20: TEdit;
    Edit19: TEdit;
    Edit18: TEdit;
    Edit17: TEdit;
    Edit16: TEdit;
    Edit15: TEdit;
    Edit14: TEdit;
    Edit13: TEdit;
    Panel5: TPanel;
    Label69: TLabel;
    Label70: TLabel;
    Label71: TLabel;
    Label72: TLabel;
    Label73: TLabel;
    Label74: TLabel;
    Label75: TLabel;
    Label76: TLabel;
    Label77: TLabel;
    Label78: TLabel;
    Label79: TLabel;
    Label80: TLabel;
    Edit58: TEdit;
    Edit57: TEdit;
    Edit56: TEdit;
    Edit55: TEdit;
    Edit54: TEdit;
    Edit53: TEdit;
    Edit52: TEdit;
    Edit51: TEdit;
    Edit50: TEdit;
    Edit49: TEdit;
    Edit48: TEdit;
    Edit47: TEdit;
    Button3: TButton;
    Panel6: TPanel;
    Label40: TLabel;
    Label41: TLabel;
    Label42: TLabel;
    Label43: TLabel;
    Label55: TLabel;
    Label56: TLabel;
    Label64: TLabel;
    Edit31: TEdit;
    Edit30: TEdit;
    Edit29: TEdit;
    Edit28: TEdit;
    Edit27: TEdit;
    Edit26: TEdit;
    Edit25: TEdit;
    Label53: TLabel;
    Edit32: TEdit;
    Edit33: TEdit;
    Edit34: TEdit;
    Edit35: TEdit;
    Edit36: TEdit;
    Edit37: TEdit;
    Edit38: TEdit;
    Edit39: TEdit;
    Edit40: TEdit;
    Edit46: TEdit;
    Label68: TLabel;
    Label50: TLabel;
    Label63: TLabel;
    Label49: TLabel;
    Label48: TLabel;
    Label47: TLabel;
    Label46: TLabel;
    Label45: TLabel;
    Label61: TLabel;
    Label44: TLabel;
    Panel7: TPanel;
    Label54: TLabel;
    Label51: TLabel;
    Label52: TLabel;
    Label65: TLabel;
    Label66: TLabel;
    Label67: TLabel;
    Edit45: TEdit;
    Edit44: TEdit;
    Edit43: TEdit;
    Edit42: TEdit;
    Edit41: TEdit;
    Panel8: TPanel;
    RadioGroup2: TRadioGroup;
    RadioGroup1: TRadioGroup;
    Label58: TLabel;
    Label59: TLabel;
    Label81: TLabel;
    Label82: TLabel;
    Edit59: TEdit;
    Edit60: TEdit;
    ComboBox14: TComboBox;
    SaveDialog1: TSaveDialog;
    Button9: TButton;
    procedure Button2Click(Sender: TObject);
    procedure Button3Click(Sender: TObject);
    procedure Button4Click(Sender: TObject);
    procedure Button5Click(Sender: TObject);
    procedure Button6Click(Sender: TObject);
    procedure Button7Click(Sender: TObject);
    procedure ComboBox13Click(Sender: TObject);
    procedure Edit1Change(Sender: TObject);
    procedure Edit2Change(Sender: TObject);
    procedure Edit3Change(Sender: TObject);
    procedure Edit4Change(Sender: TObject);
    procedure Edit5Change(Sender: TObject);
    procedure Edit6Change(Sender: TObject);
    procedure Edit7Change(Sender: TObject);
    procedure Edit8Change(Sender: TObject);
    procedure TabbedNotebook1Change(Sender: TObject; NewTab: Integer;
      var AllowChange: Boolean);
    procedure Edit10Change(Sender: TObject);
    procedure Edit11Change(Sender: TObject);
    procedure Edit12Change(Sender: TObject);
    procedure Edit9Change(Sender: TObject);
    procedure ComboBox13Change(Sender: TObject);
    procedure Edit13Change(Sender: TObject);
    procedure Edit14Change(Sender: TObject);
    procedure Edit15Change(Sender: TObject);
    procedure Edit16Change(Sender: TObject);
    procedure Edit17Change(Sender: TObject);
    procedure Edit18Change(Sender: TObject);
    procedure Edit19Change(Sender: TObject);
    procedure Edit20Change(Sender: TObject);
    procedure Edit21Change(Sender: TObject);
    procedure Edit22Change(Sender: TObject);
    procedure Edit23Change(Sender: TObject);
    procedure Edit24Change(Sender: TObject);
    procedure ComboBox1Click(Sender: TObject);
    procedure ComboBox2Click(Sender: TObject);
    procedure ComboBox3Click(Sender: TObject);
    procedure ComboBox4Click(Sender: TObject);
    procedure ComboBox5Click(Sender: TObject);
    procedure ComboBox6Click(Sender: TObject);
    procedure ComboBox7Click(Sender: TObject);
    procedure ComboBox8Click(Sender: TObject);
    procedure ComboBox9Click(Sender: TObject);
    procedure ComboBox10Click(Sender: TObject);
    procedure ComboBox11Click(Sender: TObject);
    procedure ComboBox12Click(Sender: TObject);
    procedure Button1Click(Sender: TObject);
    procedure Button8Click(Sender: TObject);
    procedure Button9Click(Sender: TObject);

  private
    { Private-Deklarationen }

     procedure ac_ob(nr:integer);
     procedure sumator;
     procedure sumator_mm;

  public
    { Public-Deklarationen }
  procedure validitate(a:array of string);

  end;

var
  Form4: TForm4;
  tot:array [1..3600,1..35] of real;
  anim: array [1..3600,1..80] of real;
  anir: array [1..3600,1..80] of real;
  saiba: array [1..3600,1..4] of real;
  ccc,ggg,gr,inter1,inter2,al,src,sdt,ipp,ii,iii,iiii:integer;
  cercmic,cercmare,maxxx,min,max,lam,xba,yba,xb,yb,rg,phig,x1,es1,es2,unghi,alfa1,alfa2,a,b,c,d,fin,si,s,sf,gi,g,gf,phi,x,y,xa,ya,xd,yd,xs,ys,ro,l3,l31,l3p,l4,l5,l1,r,rb,ep,delta,gama,niu_u,niu_c,n:real;
  ca,cas:real;
implementation

uses FLERu, FLER1, FLERp, FLER3, FLER4, FLERdesen;

{$R *.DFM}
//-----------------------------------------------------------------
//        functia pt. miscare

function  miscare(j1:integer;gi1,gf1,g1,si1,sf1,s1,phi1:real):real;
begin

if j1=0 then
begin
miscare:=si1+s1*(0.5*(1-cos(pi*(phi1-gi1)/g1)));
end;

if j1=1 then
begin
miscare:=si1+s1*((phi1-gi1)/g1-1/(2*pi)*sin(2*pi*(phi1-gi1)/g1));
end;

if j1=2 then
begin
miscare:=si1+s1*(phi1-gi1)/g1;
end;

if j1=3 then
begin
if ((phi1-gi1) <= (g1/8))
   then
   miscare:=si1+s1*((pi/(4+pi))*((phi1-gi1)/g1-(1/(4*pi))*sin(4*pi*(phi1-gi1)/g1)))
   else
       if ((phi1-gi1) <= (g1*0.875))
          then
          miscare:=si1+s1*((pi/(4+pi))*((phi1-gi1)/g1-(9/(4*pi))*sin((pi/3)*(4*(phi1-gi1)/g1+1))+2/pi))
          else
          miscare:=si1+s1*( (pi/(4+pi))*( (phi1-gi1)/g1-(1/(4*pi))*sin(4*pi*(phi1-gi1)/g1)+4/pi));
end;

if j1=4 then
begin
if ((phi1-gi1)<= (g1/8))
   then
   miscare:=si1+s1*( (2/(2+pi))*( (phi1-gi1)/g1-(1/(4*pi))*sin( 4*pi*(phi1-gi1)/g1)))
   else
       if  ((phi1-gi1)<= (3*g1/8))
           then
           miscare:=si1+s1*( (1/(2+pi))*( 4*pi*power(((phi1-gi1)/g1),2)+(2-pi)*(phi1-gi1)/g1-(pi*pi-8)/(16*pi)))
           else
               if ((phi1-gi1)<= (g1/2))
                  then
                  miscare:=si1+s1*( (2/(2+pi))*( (pi+1)*(phi1-gi1)/g1-(1/(4*pi))*sin(4*pi*((phi1-gi1)/g1-1/4))-pi/4))
                  else
                      if ((phi1-gi1)<= (g1*0.625))
                         then
                         miscare:=si1+s1*(1-(2/(2+pi))*( (pi+1)*(1-(phi1-gi1)/g1)-(1/(4*pi))*sin( 4*pi*(3/4-(phi1-gi1)/g1))-pi/4))
                         else
                             if ((phi1-gi1)<= (g1*0.875))
                                then
                                miscare:=si1+s1*(1-(1/(2+pi))*( 4*pi*power((1-(phi1-gi1)/g1),2)+(2-pi)*(1-(phi1-gi1)/g1)-(pi*pi-8)/(16*pi)))
                                else
                                miscare:=si1+s1*(1-(2/(2+pi))*( (1-(phi1-gi1)/g1)-(1/(4*pi))*sin( 4*pi*(1-(phi1-gi1)/g1) )))
end;

if j1=5 then
begin
miscare:=si1+s1*(10*power((phi1-gi1)/g1,3)-15*power((phi1-gi1)/g1,4)+6*power((phi1-gi1)/g1,5));
end;

if j1=6 then
begin
     if ((phi1-gi1) < (g1/2))
     then
     miscare:=si1+s1*(2*power((phi1-gi1)/g1,2))
     else
     miscare:=si1+s1*(1-2*power((1-(phi1-gi1)/g1),2));
end;

if j1=7 then
begin
miscare:=si1+s1*(1/(power((lam*(lam-1)),4)))*(-(7*lam*lam-4*lam)*power(((phi1-gi1)/g1),3)+3*(7*lam*lam-2*lam-1)*power(((phi1-gi1)/g1),4)-3*(7*lam*lam+2*lam-3)*power(((phi1-gi1)/g1),5)+(7*lam*lam+14*lam-9)*power(((phi1-gi1)/g1),6)-3*(2*lam-1)*power(((phi1-gi1)/g1),7));
end;

if j1=8 then
begin
cas:=(-32*pi*pi)/(15*pi*pi+8-2*lam*(9*pi*pi-4*pi+8)+lam*lam*(3*pi*pi-8*pi+8));
ca:=(-(1-lam)*(3*pi+2)*cas)/(2*lam*(2+pi));
if cas < 0  then
                ccc:=-1
            else
                ccc:=1;

     if  ((phi1-gi1)/g1) < (lam/4)
         then
         miscare:=si1+s1*((lam*ca)/(2*pi))*((phi1-gi1)/g1-(lam/(2*pi))*sin(2*pi*((phi1-gi1)/g1)/lam))
         else
             if ((phi1-gi1)/g1) < ((3*lam)/4)
                then
                miscare:=si1+s1*(ca/2)*( ((phi1-gi1)/g1-lam/4)*((phi1-gi1)/g1-lam/4)+(lam/pi)*(phi1-gi1)/g1-lam*lam/(2*pi*pi))
                else
                    if ((phi1-gi1)/g1) < lam
                       then
                       miscare:=si1+s1*((lam*ca)/(2*pi))*((1+pi)*(phi1-gi1)/g1-pi*lam/2-(lam/(2*pi))*cos( (2*pi/lam)*( (phi1-gi1)/g1-3*lam/4)))
                       else
                           if ((phi1-gi1)/g1) < ((3*lam+1)/4)
                              then
                              miscare:=si1+s1*(((1-lam)*cas)/(2*pi))*( (3*pi-2)*lam/4-3*pi*((phi1-gi1)/g1)/2-((1-lam)/(2*pi))*sin(((2*pi)/(1-lam))*((phi1-gi1)/g1-lam)))
                              else
                              miscare:=si1+s1*cas*( ((phi1-gi1)/g1-1)*((phi1-gi1)/g1-1)/2-1/(ccc*cas));
end;

if j1=9 then
begin
cas:=(-32*pi*pi)/(15*pi*pi+8-2*lam*(9*pi*pi-4*pi+8)+lam*lam*(3*pi*pi-8*pi+8));
ca:=(-(1-lam)*cas)/lam;
      if  ((phi1-gi1)/g1) < (lam/4)
          then
          miscare:=si1+s1*((lam*ca)/(2*pi))*((phi1-gi1)/g1-(lam/(2*pi))*sin(2*pi*((phi1-gi1)/g1)/lam))
          else
              if  ((phi1-gi1)/g1) < lam
                  then
                  miscare:=si1+s1*((ca*lam*lam)/(4*pi*pi))*(8+(2*pi/lam)*(phi1-gi1)/g1-9*cos(((2*pi)/(3*lam))*((phi1-gi1)/g1-lam/4)))
                  else
                  miscare:=si1+s1*((-(1-lam)*cas)/pi)*(lam*(4+pi)/(2*pi)+((4-4*lam)/pi)*sin((pi/(2-2*lam))*((phi1-gi1)/g1-lam)));
end;


if j1=10 then
begin
miscare:=si1;
end;

end;
//----------------------------------------------------
//           derivata intai

function  deriv_1(j1:integer;gi1,gf1,g1,si1,sf1,s1,phi1,fin1:real):real;
begin

if j1=0 then
begin
deriv_1:=s1*0.5*sin(pi*(phi1-gi1)/g1)*(180/g1);
end;

if j1=1 then
begin
deriv_1:=s1*(1/g1)*(180/pi)*(1-cos(2*pi*(phi1-gi1)/g1));
end;

if j1=2 then
begin
deriv_1:=s1*(1/g1)*(180/pi);
end;

if j1=3 then
begin
if (phi1-gi1) <= (g1/8)
   then
   deriv_1:=s1*180*(1/(4+pi))*(1/g1)*(1-cos(4*pi*(phi1-gi1)/g1))
   else
       if (phi1-gi1) <= (g1*0.875)
          then
          deriv_1:=s1*180*(1/(4+pi))*(1/g1)*(1-3*cos(pi*(4*(phi1-gi1)/g1+1)/3))
          else
          deriv_1:=s1*180*(1/(4+pi))*(1/g1)*(1-cos(4*pi*(phi1-gi1)/g1));
end;

if j1=4 then
begin
if (phi1-gi1)<= (g1/8)
   then
   deriv_1:=s1*(2/(2+pi))*(1/g1)*(180/pi)*(1-cos(4*pi*(phi1-gi1)/g1))
   else
       if  (phi1-gi1)<= (3*g1/8)
           then
           deriv_1:=s1*(1/(2+pi))*(1/g1)*(180/pi)*(8*pi*(phi1-gi1)/g1+2-pi)
           else
               if (phi1-gi1)<= (g1/2)
                  then
                  deriv_1:=s1*(2/(2+pi))*(1/g1)*(180/pi)*(pi+1-cos(4*pi*((phi1-gi1)/g1-(1/4))))
                  else
                      if (phi1-gi1)<= (g1*0.625)
                         then
                         deriv_1:=s1*(2/(2+pi))*(1/g1)*(180/pi)*(pi+1-cos(4*pi*((1-(phi1-gi1)/g1)-(1/4))))
                         else
                             if (phi1-gi1)<= (g1*0.875)
                                then
                                deriv_1:=s1*(1/(2+pi))*(1/g1)*(180/pi)*(8*pi*(1-(phi1-gi1)/g1)+2-pi)
                                else
                                deriv_1:=s1*(2/(2+pi))*(1/g1)*(180/pi)*(1-cos(4*pi*(1-(phi1-gi1)/g1)));
end;

if j1=5 then
begin
deriv_1:=30*s1*(180/pi)*(1/g1)*( power((phi1-gi1)/g1,2)-2*power((phi1-gi1)/g1,3)+power((phi1-gi1)/g1,4));
end;

if j1=6 then
begin
if ((phi1-gi1) < (g1/2)) then
deriv_1:=s1*4*((phi1-gi1)/g1)*(1/g1)*(180/pi)
else
deriv_1:=s1*4*180/(g1*pi)*(1-(phi1-gi1)/g1);
end;

if j1=7 then
begin
deriv_1:=s1*(3/(power((lam*(lam-1)),4)))*(-(7*lam*lam-4*lam)*power(((phi1-gi1)/g1),2)*(1/g1)*(180/pi)+4*(7*lam*lam-2*lam-1)*power(((phi1-gi1)/g1),3)*(1/g1)*(180/pi)-5*(7*lam*lam+2*lam-3)*power(((phi1-gi1)/g1),4)*(1/g1)*(180/pi)+2*(7*lam*lam+14*lam-9)*power(((phi1-gi1)/g1),5)*(1/g1)*(180/pi)-7*(2*lam-1)*power(((phi1-gi1)/g1),6)*(1/g1)*(180/pi));
end;


if j1=8 then
begin

     if  ((phi1-gi1)/g1) < (lam/4)
         then
         deriv_1:=s1*((lam*ca)/(2*pi))*(1/g1)*(180/pi)*(1-cos(2*pi*((phi1-gi1)/g1)/lam))
         else
             if ((phi1-gi1)/g1) < (3*lam/4)
                then
                deriv_1:=s1*(ca/2)*(1/g1)*(180/pi)*(2*(phi1-gi1)/g1-lam/2+lam/pi)
                else
                    if ((phi1-gi1)/g1) < lam
                       then
                       deriv_1:=s1*((lam*ca)/(2*pi))*(1/g1)*(180/pi)*(1+pi+sin((2*pi/lam)*((phi1-gi1)/g1-3*lam/4)))
                       else
                           if ((phi1-gi1)/g1) < ((3*lam+1)/4)
                              then
                              deriv_1:=s1*(((1-lam)*cas)/(2*pi))*(1/g1)*(180/pi)*(-3*pi/2-cos(((2*pi)/(1-lam))*((phi1-gi1)/g1-lam)))
                              else
                              deriv_1:=s1*cas*(1/g1)*(180/pi)*((phi1-gi1)/g1-1);


end;

if j1=9 then
begin

      if  ((phi1-gi1)/g1) < (lam/4)
          then
          deriv_1:=s1*((lam*ca)/(2*pi))*(1/g1)*(180/pi)*(1-cos(2*pi*((phi1-gi1)/g1)/lam))
          else
              if  ((phi1-gi1)/g1) < lam
                  then
                  deriv_1:=s1*((ca*lam)/(2*pi))*(1/g1)*(180/pi)*(1+3*sin(((2*pi)/(3*lam))*((phi1-gi1)/g1-lam/4)))
                  else
                  deriv_1:=s1*((-2*(1-lam)*cas)/pi)*(1/g1)*(180/pi)*cos((pi/(2-2*lam))*((phi1-gi1)/g1-lam));
end;


if j1=10 then
begin
deriv_1:=0;
end;

end;
//------------------------------------------------------------
//          derivara a II - a

function  deriv_2(j1:integer;gi1,gf1,g1,si1,sf1,s1,phi1:real):real;
begin

if j1=0 then
begin
deriv_2:=s1*0.5*cos(pi*(phi1-gi1)/g1)*(180/g1)*(180/pi);
end;

if j1=1 then
begin
deriv_2:=s1*(1/g1)*(1/g1)*(180*2*180/pi)*sin(2*pi*(phi1-gi1)/g1);
end;

if j1=2 then
begin
deriv_2:=0;
end;

if j1=3 then
begin
if (phi1-gi1) <= (g1/8)
   then
   deriv_2:=s1*4*180*180*(1/(4+pi))*(1/(g1*g1))*sin(4*pi*(phi1-gi1)/g1)
   else
       if (phi1-gi1) <= (g1*0.875)
          then
          deriv_2:=s1*4*180*180*(1/(4+pi))*(1/(g1*g1))*sin(pi*(4*(phi1-gi1)/g1+1)/3)
          else
          deriv_2:=s1*4*180*180*(1/(4+pi))*(1/(g1*g1))*sin(4*pi*(phi1-gi1)/g1);
end;

if j1=4 then
begin
if (phi1-gi1)<= (g1/8)
   then
   deriv_2:=s1*(2/(2+pi))*4*180*180/(pi*g1*g1)*sin(4*pi*(phi1-gi1)/g1)
   else
       if  (phi1-gi1)<= (3*g1/8)
           then
           deriv_2:=s1*(1/(2+pi))*8*180*180/(pi*g1*g1)
           else
               if (phi1-gi1)<= (g1/2)
                  then
                  deriv_2:=s1*(2/(2+pi))*4*180*180/(pi*g1*g1)*sin(4*pi*((phi1-gi1)/g1-(1/4)))
                  else
                      if (phi1-gi1)<= (g1*0.625)
                         then
                         deriv_2:=-s1*(2/(2+pi))*4*180*180/(pi*g1*g1)*sin(4*pi*((1-(phi1-gi1)/g1)-(1/4)))
                         else
                             if (phi1-gi1)<= (g1*0.875)
                                then
                                deriv_2:=-s1*(1/(2+pi))*8*180*180/(pi*g1*g1)
                                else
                                deriv_2:=-s1*(2/(2+pi))*4*180*180/(pi*g1*g1)*sin(4*pi*(1-(phi1-gi1)/g1));
end;

if j1=5 then
begin
deriv_2:=60*s1*(180*180/pi*pi)*(1/(g1*g1))*((phi1-gi1)/g1-3*power((phi1-gi1)/g1,2)+2*power((phi1-gi1)/g1,3));
end;

if j1=6 then
begin
if (phi1-gi1) <= g1/2 then
deriv_2:=s1*4*(1/(g1*g1))*((180*180)/(pi*pi))
else
deriv_2:=-s1*4*(1/(g1*g1))*((180*180)/(pi*pi));
end;

if j1=7 then
begin
deriv_2:=s1*(6/(power((lam*(lam-1)),4)))*(-(7*lam*lam-4*lam)*((phi1-gi1)/g1)*(1/g1)*(180/pi)*(1/g1)*(180/pi)+6*(7*lam*lam-2*lam-1)*power(((phi1-gi1)/g1),2)*(1/g1)*(180/pi)*(1/g1)*(180/pi)-10*(7*lam*lam+2*lam-3)*power(((phi1-gi1)/g1),3)*(1/g1)*(180/pi)*(1/g1)*(180/pi)+5*(7*lam*lam+14*lam-9)*power(((phi1-gi1)/g1),4)*(1/g1)*(180/pi)*(1/g1)*(180/pi)-21*(2*lam-1)*power(((phi1-gi1)/g1),5)*(1/g1)*(180/pi)*(1/g1)*(180/pi));
end;

if j1=8 then
begin

  if  ((phi1-gi1)/g1) < (lam/4)
         then
         deriv_2:=s1*ca*(1/g1)*(180/pi)*(1/g1)*(180/pi)*sin(2*pi*((phi1-gi1)/g1)/lam)
         else
             if ((phi1-gi1)/g1) < (3*lam/4)
                then
                deriv_2:=s1*ca*(1/g1)*(180/pi)*(1/g1)*(180/pi)
                else
                    if ((phi1-gi1)/g1) < lam
                       then
                       deriv_2:=s1*ca*(1/g1)*(180/pi)*(1/g1)*(180/pi)*cos((2*pi/lam)*((phi1-gi1)/g1-3*lam/4))
                       else
                           if ((phi1-gi1)/g1) < ((3*lam+1)/4)
                              then
                              deriv_2:=s1*cas*(1/g1)*(180/pi)*(1/g1)*(180/pi)*sin(((2*pi)/(1-lam))*((phi1-gi1)/g1-lam))
                              else
                              deriv_2:=s1*cas*(1/g1)*(180/pi)*(1/g1)*(180/pi);

end;

if j1=9 then
begin

  if  ((phi1-gi1)/g1) < (lam/4)
          then
          deriv_2:=s1*ca*(1/g1)*(180/pi)*(1/g1)*(180/pi)*sin(2*pi*((phi1-gi1)/g1)/lam)
          else
              if  ((phi1-gi1)/g1) < lam
                  then
                  deriv_2:=s1*ca*(1/g1)*(180/pi)*(1/g1)*(180/pi)*cos(((2*pi)/(3*lam))*((phi1-gi1)/g1-lam/4))
                  else
                  deriv_2:=s1*cas*(1/g1)*(180/pi)*(1/g1)*(180/pi)*sin((pi/(2-2*lam))*((phi1-gi1)/g1-lam));


end;


if j1=10 then
begin
deriv_2:=0;
end;

end;

//----------------------------------------------------------------
//               validare
procedure tform4.validitate(a:array of string);
var i:integer;
begin
for i:=25 to 46 do
begin
with tedit(findcomponent('edit'+inttostr(i))) do
if a[i]= 'bun' then
begin
enabled:=true;
color:=clwhite;
end
else
begin
enabled:=false;
color:=clsilver;
end;
end;
end;

//------------------------------------------------------------------
//                    sumator grade


procedure tform4.sumator;
var i :byte;z:real;
begin
form4.Label57.Caption:='0';
try
for i:=1 to 12 do
begin
with tedit(findcomponent('edit'+inttostr(i))) do
begin
if color=clsilver then
text:='0';
form4.label57.caption:=floattostr(strtofloat(form4.label57.caption)+strtofloat(text));
end;
end;
except
form4.Label57.Caption:='Nein';
end;
try
z:=360-strtofloat(form4.label57.caption);
form4.Label57.Hint:='Sie haben '+floattostr(z)+' grade mehr eingaben';
except
form4.Label57.Hint:='Sie eingaben nicht reales Nummer';
end;


end;
//--------------------------------------------------------------
//                       sumator mm
procedure tform4.sumator_mm;
var i,a :byte;
begin
form4.Label60.Caption:='0';
//try
for i:=13 to 24 do
begin
with tcombobox(findcomponent('combobox'+inttostr(i-12))) do
     if itemindex=7 //or (itemindex=8) or (itemindex=9))
            then
                begin
                a:=0;
                end
            else
                begin
                a:=1;
                end;
if a=1 then begin
            with tedit(findcomponent('edit'+inttostr(i))) do
                 begin
            try
            if color=clsilver then  text:='0';
            form4.label60.caption:=floattostr(strtofloat(form4.label60.caption)+strtofloat(text));
            except
            form4.Label60.Caption:='Nein'
            end;
                end;
            end;
end;

//except
//form4.Label60.Caption:='nu'
//end;
end;

//-----------------------------------------------------------------
//       activarea/dezacrivarea legilor de miscare

procedure tform4.ac_ob (nr:integer);
var a:byte;
begin
for a:=1 to 12 do
begin
with tcombobox(findcomponent('combobox'+inttostr(a))) do
begin
if a<= nr then
begin
enabled:=true;
end
else
begin
enabled:=false;
itemindex:=-1;
end;
if a<= nr then
color:=clwhite
else
color:=clsilver;
end;
end;

for a:=1 to 12 do
begin
with tedit(findcomponent('edit'+inttostr(a))) do
begin
if a <= nr then
enabled:= true
else
enabled:= false;

if a<= nr then
color:= clwhite
else
color:= clsilver;
end;
end;

for a:=13 to 24 do
begin
with tedit(findcomponent('edit'+inttostr(a))) do
begin
if (a-12)<= nr then
enabled:=true
else
enabled:=false;

if (a-12)<= nr then
color:=clwhite
else
color:=clsilver;
end;
end;

for a:=69 to 80 do
begin
with tlabel(findcomponent('label'+inttostr(a))) do
begin
if (a-69) >= nr then
     visible:=false;
end;
end;
for a:=47 to 58 do
begin
with tedit(findcomponent('edit'+inttostr(a))) do
begin
if (a-47) >= nr then
begin
   visible:=false;
   text:='0';
end;
end;
end;

end;

procedure TForm4.Button2Click(Sender: TObject);
begin
if MessageDlgPos('!!! Achtung Schliﬂen !!!',mtConfirmation, mbYesNoCancel, 0, 500, 400)= mryes   then
form1.close;

end;

procedure TForm4.Button3Click(Sender: TObject);
begin
form4.TabbedNotebook1.PageIndex:=1;

end;

//------------------------------------------------------------
//                      procedira back
procedure TForm4.Button4Click(Sender: TObject);
var a:byte;
begin
form4.Edit59.Text:='0';
form4.Edit60.Text:='0';
form7.Visible:=false;
form4.ComboBox13.ItemIndex:=0;
for a:=1 to 12 do
begin
with tcombobox(findcomponent('combobox'+inttostr(a))) do
begin
itemindex:=-1;
enabled:=false;
color:=clsilver;
end;
with tedit(findcomponent('edit'+inttostr(a))) do
begin
text:='0';
enabled:=false;
color:=clsilver;
end;
with tedit(findcomponent('edit'+inttostr(a+12))) do
begin
text:='0';
enabled:=false;
color:=clsilver;
end;
end;
for a:= 25 to 46 do
begin
with tedit(findcomponent('edit'+inttostr(a))) do
text:='0';
end;
form4.Edit45.text:='1';
form1.Visible:=true;
form4.Visible:=false;
end;

procedure TForm4.Button5Click(Sender: TObject);
begin
form4.TabbedNotebook1.PageIndex:=2;
end;

procedure TForm4.Button6Click(Sender: TObject);
begin
form4.TabbedNotebook1.PageIndex:=0;
end;

procedure TForm4.Button7Click(Sender: TObject);
begin
form4.TabbedNotebook1.PageIndex:=1;
end;

procedure TForm4.ComboBox13Click(Sender: TObject);
begin
form4.ac_ob(strtoint(form4.combobox13.text));
end;

procedure TForm4.Edit1Change(Sender: TObject);
begin
sumator;
end;

procedure TForm4.Edit2Change(Sender: TObject);
begin
sumator;
end;

procedure TForm4.Edit3Change(Sender: TObject);
begin
sumator;
end;

procedure TForm4.Edit4Change(Sender: TObject);
begin
sumator;
end;

procedure TForm4.Edit5Change(Sender: TObject);
begin
sumator;
end;

procedure TForm4.Edit6Change(Sender: TObject);
begin
sumator;
end;

procedure TForm4.Edit7Change(Sender: TObject);
begin
sumator;
end;

procedure TForm4.Edit8Change(Sender: TObject);
begin
sumator;
end;

procedure TForm4.TabbedNotebook1Change(Sender: TObject; NewTab: Integer;
  var AllowChange: Boolean);
begin
sumator;
end;

procedure TForm4.Edit10Change(Sender: TObject);
begin
sumator;
end;

procedure TForm4.Edit11Change(Sender: TObject);
begin
sumator;
end;

procedure TForm4.Edit12Change(Sender: TObject);
begin
sumator;
end;

procedure TForm4.Edit9Change(Sender: TObject);
begin
sumator;
end;

procedure TForm4.ComboBox13Change(Sender: TObject);
begin
sumator;
sumator_mm;
end;

procedure TForm4.Edit13Change(Sender: TObject);
begin
//if not ((form4.ComboBox1.ItemIndex=7) or (form4.ComboBox1.ItemIndex=8) or (form4.ComboBox1.ItemIndex=9)) then
sumator_mm;
end;

procedure TForm4.Edit14Change(Sender: TObject);
begin
//if not ((form4.ComboBox2.ItemIndex=7) or (form4.ComboBox2.ItemIndex=8) or (form4.ComboBox2.ItemIndex=9)) then
sumator_mm;
end;

procedure TForm4.Edit15Change(Sender: TObject);
begin
//if not ((form4.ComboBox3.ItemIndex=7) or (form4.ComboBox3.ItemIndex=8) or (form4.ComboBox3.ItemIndex=9)) then
sumator_mm;
end;

procedure TForm4.Edit16Change(Sender: TObject);
begin
//if not ((form4.ComboBox4.ItemIndex=7) or (form4.ComboBox4.ItemIndex=8) or (form4.ComboBox4.ItemIndex=9)) then
sumator_mm;
end;

procedure TForm4.Edit17Change(Sender: TObject);
begin
//if not ((form4.ComboBox5.ItemIndex=7) or (form4.ComboBox5.ItemIndex=8) or (form4.ComboBox5.ItemIndex=9)) then
sumator_mm;
end;

procedure TForm4.Edit18Change(Sender: TObject);
begin
//if not ((form4.ComboBox6.ItemIndex=7) or (form4.ComboBox6.ItemIndex=8) or (form4.ComboBox6.ItemIndex=9)) then
sumator_mm;
end;

procedure TForm4.Edit19Change(Sender: TObject);
begin
//if not ((form4.ComboBox7.ItemIndex=7) or (form4.ComboBox7.ItemIndex=8) or (form4.ComboBox7.ItemIndex=9)) then
sumator_mm;
end;

procedure TForm4.Edit20Change(Sender: TObject);
begin
//if not ((form4.ComboBox8.ItemIndex=7) or (form4.ComboBox8.ItemIndex=8) or (form4.ComboBox8.ItemIndex=9)) then
sumator_mm;
end;

procedure TForm4.Edit21Change(Sender: TObject);
begin
//if not ((form4.ComboBox9.ItemIndex=7) or (form4.ComboBox9.ItemIndex=8) or (form4.ComboBox9.ItemIndex=9)) then
sumator_mm;
end;

procedure TForm4.Edit22Change(Sender: TObject);
begin
//if not ((form4.ComboBox10.ItemIndex=7) or (form4.ComboBox10.ItemIndex=8) or (form4.ComboBox10.ItemIndex=9)) then
sumator_mm;
end;

procedure TForm4.Edit23Change(Sender: TObject);
begin
//if not ((form4.ComboBox11.ItemIndex=7) or (form4.ComboBox11.ItemIndex=8) or (form4.ComboBox11.ItemIndex=9)) then
sumator_mm;
end;

procedure TForm4.Edit24Change(Sender: TObject);
begin
//if not ((form4.ComboBox12.ItemIndex=7) or (form4.ComboBox12.ItemIndex=8) or (form4.ComboBox12.ItemIndex=9)) then
sumator_mm;
end;

procedure TForm4.ComboBox1Click(Sender: TObject);
begin
if form4.ComboBox1.ItemIndex= 10 then
begin
form4.Edit13.text:='0';
form4.Edit13.Enabled:=false;
form4.Edit13.Color:=clsilver;
end
else
begin
form4.Edit13.Enabled:=true;
form4.Edit13.Color:=clwhite;
end;

if ((form4.ComboBox1.ItemIndex=7) or (form4.ComboBox1.ItemIndex=8) or (form4.ComboBox1.ItemIndex=9))
   then
   begin
   //sumator_mm;
   //form4.Label60.Caption:=floattostr(strtofloat(form4.label60.caption)-strtofloat(form4.edit13.text));
   form4.Label69.Visible:=true;
   form4.Edit47.Visible:=true;
   form4.Edit47.Text:='0';
   end
   else
   begin
   //sumator_mm;
   form4.Label69.Visible:=false;
   form4.Edit47.Visible:=false;
   end;
sumator_mm;
end;

procedure TForm4.ComboBox2Click(Sender: TObject);
begin
if form4.ComboBox2.ItemIndex= 10 then
begin
form4.Edit14.text:='0';
form4.Edit14.Enabled:=false;
form4.Edit14.Color:=clsilver;
end
else
begin
form4.Edit14.Enabled:=true;
form4.Edit14.Color:=clwhite;
end;

if ((form4.ComboBox2.ItemIndex=7) or (form4.ComboBox2.ItemIndex=8) or (form4.ComboBox2.ItemIndex=9))
   then
   begin
   form4.Label70.Visible:=true;
   form4.Edit48.Visible:=true;
   form4.Edit48.Text:='0';
   end
   else
   begin
   form4.Label70.Visible:=false;
   form4.Edit48.Visible:=false;
   end;
sumator_mm;
end;

procedure TForm4.ComboBox3Click(Sender: TObject);
begin
if form4.ComboBox3.ItemIndex= 10 then
begin
form4.Edit15.text:='0';
form4.Edit15.Enabled:=false;
form4.Edit15.Color:=clsilver;
end
else
begin
form4.Edit15.Enabled:=true;
form4.Edit15.Color:=clwhite;
end;

if ((form4.ComboBox3.ItemIndex=7) or (form4.ComboBox3.ItemIndex=8) or (form4.ComboBox3.ItemIndex=9))
   then
   begin
   form4.Label71.Visible:=true;
   form4.Edit49.Visible:=true;
   form4.Edit49.Text:='0';
   end
   else
   begin
   form4.Label71.Visible:=false;
   form4.Edit49.Visible:=false;
   end;
sumator_mm;
end;

procedure TForm4.ComboBox4Click(Sender: TObject);
begin
if form4.ComboBox4.ItemIndex= 10 then
begin
form4.Edit16.text:='0';
form4.Edit16.Enabled:=false;
form4.Edit16.Color:=clsilver;
end
else
begin
form4.Edit16.Enabled:=true;
form4.Edit16.Color:=clwhite;
end;

if ((form4.ComboBox4.ItemIndex=7) or (form4.ComboBox4.ItemIndex=8) or (form4.ComboBox4.ItemIndex=9))
   then
   begin
   form4.Label72.Visible:=true;
   form4.Edit50.Visible:=true;
   form4.Edit50.Text:='0';
   end
   else
   begin
   form4.Label72.Visible:=false;
   form4.Edit50.Visible:=false;
   end;
sumator_mm;
end;

procedure TForm4.ComboBox5Click(Sender: TObject);
begin
if form4.ComboBox5.ItemIndex= 10 then
begin
form4.Edit17.text:='0';
form4.Edit17.Enabled:=false;
form4.Edit17.Color:=clsilver;
end
else
begin
form4.Edit17.Enabled:=true;
form4.Edit17.Color:=clwhite;
end;

if ((form4.ComboBox5.ItemIndex=7) or (form4.ComboBox5.ItemIndex=8) or (form4.ComboBox5.ItemIndex=9))
   then
   begin
   form4.Label73.Visible:=true;
   form4.Edit51.Visible:=true;
   form4.Edit51.Text:='0';
   end
   else
   begin
   form4.Label73.Visible:=false;
   form4.Edit51.Visible:=false;
   end;
sumator_mm;
end;

procedure TForm4.ComboBox6Click(Sender: TObject);
begin
if form4.ComboBox6.ItemIndex= 10 then
begin
form4.Edit18.text:='0';
form4.Edit18.Enabled:=false;
form4.Edit18.Color:=clsilver;
end
else
begin
form4.Edit18.Enabled:=true;
form4.Edit18.Color:=clwhite;
end;

if ((form4.ComboBox6.ItemIndex=7) or (form4.ComboBox6.ItemIndex=8) or (form4.ComboBox6.ItemIndex=9))
   then
   begin
   form4.Label74.Visible:=true;
   form4.Edit52.Visible:=true;
   form4.Edit52.Text:='0';
   end
   else
   begin
   form4.Label74.Visible:=false;
   form4.Edit52.Visible:=false;
   end;
sumator_mm;
end;

procedure TForm4.ComboBox7Click(Sender: TObject);
begin
if form4.ComboBox7.ItemIndex= 10 then
begin
form4.Edit19.text:='0';
form4.Edit19.Enabled:=false;
form4.Edit19.Color:=clsilver;
end
else
begin
form4.Edit19.Enabled:=true;
form4.Edit19.Color:=clwhite;
end;

if ((form4.ComboBox7.ItemIndex=7) or (form4.ComboBox7.ItemIndex=8) or (form4.ComboBox7.ItemIndex=9))
   then
   begin
   form4.Label75.Visible:=true;
   form4.Edit53.Visible:=true;
   form4.Edit53.Text:='0';
   end
   else
   begin
   form4.Label75.Visible:=false;
   form4.Edit53.Visible:=false;
   end;
sumator_mm;
end;

procedure TForm4.ComboBox8Click(Sender: TObject);
begin
if form4.ComboBox8.ItemIndex= 10 then
begin
form4.Edit20.text:='0';
form4.Edit20.Enabled:=false;
form4.Edit20.Color:=clsilver;
end
else
begin
form4.Edit20.Enabled:=true;
form4.Edit20.Color:=clwhite;
end;

if ((form4.ComboBox8.ItemIndex=7) or (form4.ComboBox8.ItemIndex=8) or (form4.ComboBox8.ItemIndex=9))
   then
   begin
   form4.Label76.Visible:=true;
   form4.Edit54.Visible:=true;
   form4.Edit54.Text:='0';
   end
   else
   begin
   form4.Label76.Visible:=false;
   form4.Edit54.Visible:=false;
   end;
sumator_mm;
end;

procedure TForm4.ComboBox9Click(Sender: TObject);
begin
if form4.ComboBox9.ItemIndex= 10 then
begin
form4.Edit21.text:='0';
form4.Edit21.Enabled:=false;
form4.Edit21.Color:=clsilver;
end
else
begin
form4.Edit21.Enabled:=true;
form4.Edit21.Color:=clwhite;
end;

if ((form4.ComboBox9.ItemIndex=7) or (form4.ComboBox9.ItemIndex=8) or (form4.ComboBox9.ItemIndex=9))
   then
   begin
   form4.Label77.Visible:=true;
   form4.Edit55.Visible:=true;
   form4.Edit55.Text:='0';
   end
   else
   begin
   form4.Label77.Visible:=false;
   form4.Edit55.Visible:=false;
   end;
sumator_mm;
end;

procedure TForm4.ComboBox10Click(Sender: TObject);
begin
if form4.ComboBox10.ItemIndex= 10 then
begin
form4.Edit22.text:='0';
form4.Edit22.Enabled:=false;
form4.Edit22.Color:=clsilver;
end
else
begin
form4.Edit22.Enabled:=true;
form4.Edit22.Color:=clwhite;
end;

if ((form4.ComboBox10.ItemIndex=7) or (form4.ComboBox10.ItemIndex=8) or (form4.ComboBox10.ItemIndex=9))
   then
   begin
   form4.Label78.Visible:=true;
   form4.Edit56.Visible:=true;
   form4.Edit56.Text:='0';
   end
   else
   begin
   form4.Label78.Visible:=false;
   form4.Edit56.Visible:=false;
   end;
sumator_mm;
end;

procedure TForm4.ComboBox11Click(Sender: TObject);
begin
if form4.ComboBox11.ItemIndex= 10 then
begin
form4.Edit23.text:='0';
form4.Edit23.Enabled:=false;
form4.Edit23.Color:=clsilver;
end
else
begin
form4.Edit23.Enabled:=true;
form4.Edit23.Color:=clwhite;
end;

if ((form4.ComboBox11.ItemIndex=7) or (form4.ComboBox11.ItemIndex=8) or (form4.ComboBox11.ItemIndex=9))
   then
   begin
   form4.Label79.Visible:=true;
   form4.Edit57.Visible:=true;
   form4.Edit57.Text:='0';
   end
   else
   begin
   form4.Label79.Visible:=false;
   form4.Edit57.Visible:=false;
   end;
sumator_mm;
end;

procedure TForm4.ComboBox12Click(Sender: TObject);
begin
if form4.ComboBox12.ItemIndex= 10 then
begin
form4.Edit24.text:='0';
form4.Edit24.Enabled:=false;
form4.Edit24.Color:=clsilver;
end
else
begin
form4.Edit24.Enabled:=true;
form4.Edit24.Color:=clwhite;
end;

if ((form4.ComboBox12.ItemIndex=7) or (form4.ComboBox12.ItemIndex=8) or (form4.ComboBox12.ItemIndex=9))
   then
   begin
   form4.Label80.Visible:=true;
   form4.Edit58.Visible:=true;
   form4.Edit58.Text:='0';
   end
   else
   begin
   form4.Label80.Visible:=false;
   form4.Edit58.Visible:=false;
   end;
sumator_mm;
end;


//-----------------------------------------------------------
//        calculul profilului camei

procedure profil_cama1(t:integer);
var   aa:real;
begin

if form1.RadioGroup1.ItemIndex=0 then
begin
         aa:=sqrt(xa*xa+ya*ya);

         tot[1,13]:=l3*cos(tot[1,ii]);
         tot[1,14]:=l3*sin(tot[1,ii]);
         tot[1,17]:=sqrt(power((tot[1,13]-xa),2)+power((tot[1,14]-ya),2));

         if al=2
            then
                begin
                tot[1,18]:=-arccos((l3*l3+aa*aa-tot[1,17]*tot[1,17])/(2*l3*aa));
                end
            else
                begin
                tot[1,18]:=arccos((l3*l3+aa*aa-tot[1,17]*tot[1,17])/(2*l3*aa));
                end;

         tot[t,15]:=xa*(1-cos(src*(t/10-0.1)*pi/180)+(l3/aa)*cos(tot[1,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180))-ya*(sin(src*(t/10-0.1)*pi/180)+(l3/aa)*sin(tot[1,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180));
         tot[t,16]:=xa*(sin(src*(t/10-0.1)*pi/180)+(l3/aa)*sin(tot[1,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180))+ya*(1-cos(src*(t/10-0.1)*pi/180)+(l3/aa)*cos(tot[1,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180));

         tot[t,19]:=xa*(src*sin(src*(t/10-0.1)*pi/180)-(tot[t,iii]-1*src)*(l3/aa)*sin(tot[1,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180))-ya*(src*cos(src*(t/10-0.1)*pi/180)+(tot[t,iii]-1*src)*(l3/aa)*cos(tot[1,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180));
         tot[t,20]:=xa*(src*cos(src*(t/10-0.1)*pi/180)+(tot[t,iii]-1*src)*(l3/aa)*cos(tot[1,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180))+ya*(src*sin(src*(t/10-0.1)*pi/180)-(tot[t,iii]-1*src)*(l3/aa)*sin(tot[1,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180));

         tot[t,23]:=tot[t,15]+src*r*(tot[t,20])/(sqrt(power(tot[t,19],2)+power(tot[t,20],2)));
         tot[t,24]:=tot[t,16]-src*r*(tot[t,19])/(sqrt(power(tot[t,19],2)+power(tot[t,20],2)));

         tot[t,21]:=xa*(cos(src*(t/10-0.1)*pi/180)-tot[t,iiii]*(l3/aa)*sin(tot[1,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180)-(tot[t,iii]-1*src)*(tot[t,iii]-1*src)*(l3/aa)*cos(tot[1,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180))+ya*(sin(src*(t/10-0.1)*pi/180)-tot[t,iiii]*(l3/aa)*cos(tot[1,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180)+(tot[t,iii]-1*src)*(tot[t,iii]-1*src)*(l3/aa)*sin(tot[1,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180));
         tot[t,22]:=xa*(-sin(src*(t/10-0.1)*pi/180)+tot[t,iiii]*(l3/aa)*cos(tot[1,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180)-(tot[t,iii]-1*src)*(tot[t,iii]-1*src)*(l3/aa)*sin(tot[1,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180))+ya*(cos(src*(t/10-0.1)*pi/180)-tot[t,iiii]*(l3/aa)*sin(tot[1,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180)-(tot[t,iii]-1*src)*(tot[t,iii]-1*src)*(l3/aa)*cos(tot[1,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180));

         tot[t,31]:=(sqrt(power((tot[t,19]*tot[t,19]+tot[t,20]*tot[t,20]),3)))/(tot[t,19]*tot[t,22]-tot[t,21]*tot[t,20]);

  try
         tot[t,32]:=src*pi/2-src*arccos((tot[t,19]*(tot[t,16]-ya)-tot[t,20]*(tot[t,15]-xa))/(sqrt(tot[t,19]*tot[t,19]+tot[t,20]*tot[t,20])*sqrt((tot[t,15]-xa)*(tot[t,15]-xa)+(tot[t,16]-ya)*(tot[t,16]-ya))));
  except

         tot[t,32]:=pi/2;
  end;

  if form6.RadioGroup1.ItemIndex=1 then
        begin
         tot[2,13]:=l31*cos(tot[1,ii]+gama*pi/180);
         tot[2,14]:=l31*sin(tot[1,ii]+gama*pi/180);

         tot[2,17]:=sqrt(power((tot[2,13]-xa),2)+power((tot[2,14]-ya),2));
         tot[2,18]:=arccos((l31*l31+aa*aa-tot[2,17]*tot[2,17])/(2*l31*aa));

         if gama<0 then tot[2,18]:=-tot[2,18];

         tot[t,25]:=xa*(1-cos(src*(t/10-0.1)*pi/180)+(l31/aa)*cos(tot[2,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180))-ya*(sin(src*(t/10-0.1)*pi/180)+(l31/aa)*sin(tot[2,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180));
         tot[t,26]:=xa*(sin(src*(t/10-0.1)*pi/180)+(l31/aa)*sin(tot[2,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180))+ya*(1-cos(src*(t/10-0.1)*pi/180)+(l31/aa)*cos(tot[2,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180));

         tot[t,19]:=xa*(src*sin(src*(t/10-0.1)*pi/180)-(tot[t,iii]-1*src)*(l31/aa)*sin(tot[2,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180))-ya*(src*cos(src*(t/10-0.1)*pi/180)+(tot[t,iii]-1*src)*(l31/aa)*cos(tot[2,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180));
         tot[t,20]:=xa*(src*cos(src*(t/10-0.1)*pi/180)+(tot[t,iii]-1*src)*(l31/aa)*cos(tot[2,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180))+ya*(src*sin(src*(t/10-0.1)*pi/180)-(tot[t,iii]-1*src)*(l31/aa)*sin(tot[2,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180));

         tot[t,27]:=tot[t,25]+src*r*(tot[t,20])/(sqrt(power(tot[t,19],2)+power(tot[t,20],2)));
         tot[t,28]:=tot[t,26]-src*r*(tot[t,19])/(sqrt(power(tot[t,19],2)+power(tot[t,20],2)));

        end;

  if form6.RadioGroup1.ItemIndex=2 then
        begin
         tot[t,29]:=tot[t,15]-src*r*(tot[t,20])/(sqrt(power(tot[t,19],2)+power(tot[t,20],2)));
         tot[t,30]:=tot[t,16]+src*r*(tot[t,19])/(sqrt(power(tot[t,19],2)+power(tot[t,20],2)));
        end;

  if form6.RadioGroup1.ItemIndex=3 then
        begin
         tot[2,13]:=l31*cos(tot[1,ii]+gama*pi/180);
         tot[2,14]:=l31*sin(tot[1,ii]+gama*pi/180);

         tot[2,17]:=sqrt(power((tot[2,13]-xa),2)+power((tot[2,14]-ya),2));

         if al=2 then tot[2,18]:=-arccos((l31*l31+aa*aa-tot[2,17]*tot[2,17])/(2*l31*aa))
            else tot[2,18]:=arccos((l31*l31+aa*aa-tot[2,17]*tot[2,17])/(2*l31*aa));
     //   tot[2,18]:=arccos((l31*l31+aa*aa-tot[2,17]*tot[2,17])/(2*l31*aa));
     //    if gama<0 then tot[2,18]:=-tot[2,18];

         tot[t,25]:=xa*(1-cos(src*(t/10-0.1)*pi/180)+(l31/aa)*cos(tot[2,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180))-ya*(sin(src*(t/10-0.1)*pi/180)+(l31/aa)*sin(tot[2,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180));
         tot[t,26]:=xa*(sin(src*(t/10-0.1)*pi/180)+(l31/aa)*sin(tot[2,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180))+ya*(1-cos(src*(t/10-0.1)*pi/180)+(l31/aa)*cos(tot[2,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180));

         tot[t,19]:=xa*(src*sin(src*(t/10-0.1)*pi/180)-(tot[t,iii]-1*src)*(l31/aa)*sin(tot[2,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180))-ya*(src*cos(src*(t/10-0.1)*pi/180)+(tot[t,iii]-1*src)*(l31/aa)*cos(tot[2,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180));
         tot[t,20]:=xa*(src*cos(src*(t/10-0.1)*pi/180)+(tot[t,iii]-1*src)*(l31/aa)*cos(tot[2,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180))+ya*(src*sin(src*(t/10-0.1)*pi/180)-(tot[t,iii]-1*src)*(l31/aa)*sin(tot[2,18]+tot[t,ii]-tot[1,ii]-src*(t/10-0.1)*pi/180));

         tot[t,27]:=tot[t,25]-src*r*(tot[t,20])/(sqrt(power(tot[t,19],2)+power(tot[t,20],2)));
         tot[t,28]:=tot[t,26]+src*r*(tot[t,19])/(sqrt(power(tot[t,19],2)+power(tot[t,20],2)));

        end;
end //de la then
else
begin
     tot[1,14]:=(tot[1,7]-l3);
     tot[1,17]:=sqrt(xa*xa+power((tot[1,14]-ya),2));
     tot[1,18]:=sqrt(tot[1,17]*tot[1,17]-xa*xa);

     tot[t,15]:=xa*(1-cos(src*(t/10-0.1)*pi/180))+(tot[1,18]+tot[t,ii]-tot[1,7])*sin(src*(t/10-0.1)*pi/180);
     tot[t,16]:=ya+xa*sin(src*(t/10-0.1)*pi/180)+(tot[1,18]+tot[t,ii]-tot[1,7])*cos(src*(t/10-0.1)*pi/180);

     tot[t,19]:=src*(tot[1,18]+tot[t,ii]-tot[1,7])*cos(src*(t/10-0.1)*pi/180)+(src*xa+tot[t,iii])*sin(src*(t/10-0.1)*pi/180);
     tot[t,20]:=-src*(tot[1,18]+tot[t,ii]-tot[1,7])*sin(src*(t/10-0.1)*pi/180)+(src*xa+tot[t,iii])*cos(src*(t/10-0.1)*pi/180);

     tot[t,23]:=tot[t,15]+src*r*(tot[t,20])/(sqrt(tot[t,19]*tot[t,19]+tot[t,20]*tot[t,20]));
     tot[t,24]:=tot[t,16]-src*r*(tot[t,19])/(sqrt(tot[t,19]*tot[t,19]+tot[t,20]*tot[t,20]));

     tot[t,21]:=(tot[t,iiii]-tot[1,18]-tot[t,ii]+tot[1,ii])*sin(src*(t/10-0.1)*pi/180)+(xa+src*2*tot[t,iii])*cos(src*(t/10-0.1)*pi/180);
     tot[t,22]:=(tot[t,iiii]-tot[1,18]-tot[t,ii]+tot[1,ii])*cos(src*(t/10-0.1)*pi/180)-(xa+src*2*tot[t,iii])*sin(src*(t/10-0.1)*pi/180);

     tot[t,31]:=-(sqrt(power((tot[t,19]*tot[t,19]+tot[t,20]*tot[t,20]),3)))/(tot[t,19]*tot[t,22]-tot[t,21]*tot[t,20]);

  try
         tot[t,32]:=src*pi/2-src*arccos((tot[t,19]*(tot[t,16]-ya)-tot[t,20]*(tot[t,15]-xa))/(sqrt(tot[t,19]*tot[t,19]+tot[t,20]*tot[t,20])*sqrt((tot[t,15]-xa)*(tot[t,15]-xa)+(tot[t,16]-ya)*(tot[t,16]-ya))));
  except
         tot[t,32]:=pi/2;
  end;

  if form6.RadioGroup2.ItemIndex=1 then
        begin
        tot[2,13]:=xa+ep;
        tot[2,14]:=(tot[1,7]-(l3+l31));

        tot[2,17]:=sqrt(ep*ep+power((tot[2,14]-ya),2));
        tot[2,18]:=sqrt(tot[2,17]*tot[2,17]-ep*ep);

        tot[t,25]:=tot[2,13]-xa*(1-cos(src*(t/10-0.1)*pi/180))-(tot[2,18]-tot[t,ii]+tot[1,7])*sin(src*(t/10-0.1)*pi/180);
        tot[t,26]:=ya-xa*sin(src*(t/10-0.1)*pi/180)-(tot[2,18]-tot[t,ii]+tot[1,7])*cos(src*(t/10-0.1)*pi/180);

        tot[t,19]:=-src*(tot[2,18]-tot[t,ii]+tot[1,7])*cos(src*(t/10-0.1)*pi/180)+(-src*xa+tot[t,iii])*sin(src*(t/10-0.1)*pi/180);
        tot[t,20]:=src*(tot[2,18]-tot[t,ii]+tot[1,7])*sin(src*(t/10-0.1)*pi/180)+(-src*xa+tot[t,iii])*cos(src*(t/10-0.1)*pi/180);

        tot[t,27]:=tot[t,25]+src*r*(tot[t,20])/(sqrt(tot[t,19]*tot[t,19]+tot[t,20]*tot[t,20]));
        tot[t,28]:=tot[t,26]-src*r*(tot[t,19])/(sqrt(tot[t,19]*tot[t,19]+tot[t,20]*tot[t,20]));
        end;

  if form6.RadioGroup2.ItemIndex=2 then
        begin
         tot[t,29]:=tot[t,15]-src*r*(tot[t,20])/(sqrt(tot[t,19]*tot[t,19]+tot[t,20]*tot[t,20]));
         tot[t,30]:=tot[t,16]+src*r*(tot[t,19])/(sqrt(tot[t,19]*tot[t,19]+tot[t,20]*tot[t,20]));
        end;

  if form6.RadioGroup2.ItemIndex=3 then
        begin
         tot[2,14]:=(tot[1,7]-l3-l31);
         tot[2,17]:=sqrt(xa*xa+power((tot[2,14]-ya),2));
         tot[2,18]:=sqrt(tot[2,17]*tot[2,17]-xa*xa);

         tot[t,25]:=xa*(1-cos(src*(t/10-0.1)*pi/180))+(tot[2,18]+tot[t,ii]-tot[1,7])*sin(src*(t/10-0.1)*pi/180);
         tot[t,26]:=ya+xa*sin(src*(t/10-0.1)*pi/180)+(tot[2,18]+tot[t,ii]-tot[1,7])*cos(src*(t/10-0.1)*pi/180);

         tot[t,19]:=src*(tot[2,18]+tot[t,ii]-tot[1,7])*cos(src*(t/10-0.1)*pi/180)+(src*xa+tot[t,iii])*sin(src*(t/10-0.1)*pi/180);
         tot[t,20]:=-src*(tot[2,18]+tot[t,ii]-tot[1,7])*sin(src*(t/10-0.1)*pi/180)+(src*xa+tot[t,iii])*cos(src*(t/10-0.1)*pi/180);

         tot[t,27]:=tot[t,25]-src*r*(tot[t,20])/(sqrt(tot[t,19]*tot[t,19]+tot[t,20]*tot[t,20]));
         tot[t,28]:=tot[t,26]+src*r*(tot[t,19])/(sqrt(tot[t,19]*tot[t,19]+tot[t,20]*tot[t,20]));
        end;
end;  //  de la else

end;

procedure TForm4.Button1Click(Sender: TObject);
var vvv,uuu,inc,control1,control2,control3,m,i,j,k,min1,max1:integer;
    nn,vvv1:real;
    control:array [1..3600] of real;
    ac:boolean;
    incun:real;

begin
{if ((form1.RadioGroup1.ItemIndex=0) and (form2.RadioGroup1.ItemIndex=0))
   then
       begin
       form5.CheckBox4.Enabled:=false;
       form5.CheckBox5.Enabled:=false;
       form5.CheckBox6.Enabled:=false;
       form5.CheckBox25.Enabled:=false;
       end
   else
       begin
       form5.CheckBox4.Enabled:=true;
       form5.CheckBox5.Enabled:=true;
       form5.CheckBox6.Enabled:=true;
       form5.CheckBox25.Enabled:=true;
       if ((form1.RadioGroup1.ItemIndex=1) and (form3.RadioGroup1.ItemIndex=0))
          then
              begin
              form5.CheckBox4.Enabled:=false;
              form5.CheckBox5.Enabled:=false;
              form5.CheckBox6.Enabled:=false;
              form5.CheckBox25.Enabled:=false;
              end
          else
              begin
              form5.CheckBox4.Enabled:=true;
              form5.CheckBox5.Enabled:=true;
              form5.CheckBox6.Enabled:=true;
              form5.CheckBox25.Enabled:=true;
              end;
       end;
 }

hhh:=1;
zzz:=3;

form7.Visible:=false;

inter1:=0;
inter2:=0;

form5.memo1.clear;
xa:=strtofloat(form4.edit25.text);
ya:=strtofloat(form4.edit26.text);
xd:=strtofloat(form4.edit27.text);
yd:=strtofloat(form4.edit28.text);
xs:=strtofloat(form4.edit29.text);
ys:=strtofloat(form4.edit30.text);
ro:=strtofloat(form4.edit31.text);
l3:=strtofloat(form4.edit32.text);
l31:=strtofloat(form4.edit33.text);
l3p:=strtofloat(form4.edit34.text);
l4:=strtofloat(form4.edit35.text);
l5:=strtofloat(form4.edit36.text);
l1:=strtofloat(form4.edit37.text);
r:=strtofloat(form4.edit38.text);
rb:=strtofloat(form4.edit39.text);
ep:=strtofloat(form4.edit40.text);
delta:=strtofloat(form4.edit41.text);
gama:=strtofloat(form4.edit42.text);
niu_u:=strtofloat(form4.edit43.text);
niu_c:=strtofloat(form4.edit44.text);
n:=strtofloat(form4.edit45.text);
x1:=strtofloat(form4.edit46.text);
cercmic:=strtofloat(form4.edit59.text);
cercmare:=strtofloat(form4.edit60.text);
if form4.RadioGroup1.ItemIndex=0
   then
       begin
       src:=1;
       gr:=0;
       end
   else
       begin
       src:=-1;
       gr:=1;
       end;
if form4.RadioGroup2.ItemIndex=0 then
sdt:=1
else
sdt:=-1;

//-----------------
//   incepe calculul

for i:= 1 to 3600 do
    for j:= 1 to 35 do
        tot[i,j]:=0;

sf:=0;
k:=1;
gf:=0;
phi:=0;
fin:=0;
inc:=1;
if strtoint(form4.ComboBox13.Text) < 1  then
begin
form4.TabbedNotebook1.PageIndex:=0;
MessageDlg('                !!! Achtung!!!'+#13+'Muﬂ ein minimal abschnitt Aktive sein !!!', mtinformation,[mbOk], 0);
exit;
end;

for i:=1 to strtoint(form4.combobox13.text) do
begin
with tcombobox(findcomponent('combobox'+inttostr(i))) do
begin
if itemindex = -1  then
begin
form4.TabbedNotebook1.PageIndex:=0;
MessageDlg('                      !!! Achtung !!!'+#13+'Nach abschnitt '+inttostr(i)+'. muss eingaben  die bewegung !!!', mtinformation,[mbOk], 0);
exit;
end;
end;
end;
for i:=1 to strtoint(form4.combobox13.text) do
begin
with tedit(findcomponent('edit'+inttostr(i))) do
begin
if strtofloat(text) <= 0 then
begin
form4.TabbedNotebook1.PageIndex:=0;
MessageDlg('                !!! Achtung !!!'+#13+'Nach abschnitt '+inttostr(i)+'. phi muss ein positiv nummer sein !!!', mtinformation,[mbOk], 0);
exit;
end;
end;
end;

if form4.Label57.Caption <> '360' then
begin
form4.TabbedNotebook1.PageIndex:=0;
MessageDlg('                !!! Achtung !!!'+#13+'muss Summe die Grades 360 sein !!!', mtinformation,[mbOk], 0);
exit;
end;

for i:=1 to strtoint(form4.combobox13.text) do
begin
with tedit(findcomponent('edit'+inttostr(i+12))) do
begin
if color <> clsilver then
if strtofloat(text) = 0  then
begin
form4.TabbedNotebook1.PageIndex:=0;
MessageDlg('                 !!! Achtung !!!'+#13+'Nach abschnitt '+inttostr(i)+'. eingaben nicht die Verlagerung sein !!!', mtinformation,[mbOk], 0);
exit;
end;
end;
end;

if form4.Label60.Caption <> '0' then
begin
form4.TabbedNotebook1.PageIndex:=0;
MessageDlg('                !!! Achtung !!!'+#13+'muss die Verlagerung summe 0 sein !!!', mtinformation,[mbOk], 0);
exit;
end;

for i:=1 to strtoint(form4.combobox13.text) do
begin
with tcombobox(findcomponent('combobox'+inttostr(i))) do
begin
if ((itemindex=7) or (itemindex=8) or (itemindex=9))
   then vvv:=1
   else vvv:=0;
end;
if vvv=1 then
begin
     with tedit(findcomponent('edit'+inttostr(i))) do
          begin
          vvv1:=strtofloat(text);
          end;
     with tedit(findcomponent('edit'+inttostr(i+46))) do
          begin
          if (( strtofloat(text)>= vvv1) or (strtofloat(text) <=(vvv1-vvv1))) then
            begin
            form4.TabbedNotebook1.PageIndex:=0;
            MessageDlg('                !!! Achtung !!!'+#13+'lamda muss zwischen 0 und '+floattostr(vvv1)+#13+'       sein, nach abschnitt '+inttostr(i)+'. ', mtinformation,[mbOk], 0);
            exit;
            end;
          end;
end;
end;
if ((xa=0) and (ya=0) and (l3=0)) then
begin
form4.TabbedNotebook1.PageIndex:=1;
MessageDlg('                !!! Achtung !!!'+#13+'muss eingaben numerische datei', mtinformation,[mbOk], 0);
exit;
end;
{
if (n<0) or  ((10*n)/(int(10*n))>1)
then
begin
form4.TabbedNotebook1.PageIndex:=1;
MessageDlg('                  !!! Achtung !!!'+#13+'n(grad)  muss teilbar mit 0,1 und >0 sein', mtinformation,[mbOk], 0);
exit;

end;
}

//---------------------------------------
// calculul legilor de miscare, vitezelor si acceleratiilor

for i:=1 to strtoint(form4.combobox13.text) do
begin
     with tcombobox(findcomponent('combobox'+inttostr(i))) do
          begin
          if ((itemindex=7) or (itemindex=8) or (itemindex=9))
             then
             ggg:=1
             else
             ggg:=0;
          end;

     with tcombobox(findcomponent('combobox'+inttostr(i))) do
          begin
          if itemindex=7
             then
             uuu:=1
             else
             uuu:=0;
          end;

     with tedit(findcomponent('edit'+inttostr(i))) do
          begin
          gi:=gf;
          gf:=gf+strtofloat(text);
          g:=strtofloat(text);
          end;

     with tedit(findcomponent('edit'+inttostr(i+12))) do
          begin
          if form1.RadioGroup1.ItemIndex=0 then
                                               if ((form2.RadioGroup1.ItemIndex=0) or (form2.RadioGroup1.ItemIndex=2))
                                               then
                                               begin
                                                    if uuu=1 then
                                                       begin
                                                       s:=sdt*strtofloat(text)*pi/180;
                                                       si:=sf;
                                                       end
                                                    else
                                                   begin
                                                   si:=sf;
                                                   sf:=sf+sdt*(strtofloat(text)*pi/180);
                                                   s:=sdt*strtofloat(text)*pi/180;
                                                   end;
                                               end
                                               else
                                               begin
                                                    if uuu=1 then
                                                       begin
                                                       s:=sdt*strtofloat(text);
                                                       si:=sf;
                                                       end
                                                    else
                                                   begin
                                                   si:=sf;
                                                   sf:=sf+sdt*strtofloat(text);
                                                   s:=sdt*strtofloat(text);
                                                   end;
                                               end
                                            else
                                                if form3.RadioGroup1.ItemIndex=2  then
                                                begin
                                                if uuu=1 then
                                                   begin
                                                   s:=sdt*strtofloat(text)*pi/180;
                                                   si:=sf;
                                                   end
                                                  else
                                                   begin
                                                   si:=sf;
                                                   sf:=sf+sdt*(strtofloat(text)*pi/180);
                                                   s:=sdt*strtofloat(text)*pi/180;
                                                   end;
                                                end
                                                else
                                                begin
                                                if uuu=1 then
                                                   begin
                                                   s:=sdt*strtofloat(text);
                                                   si:=sf;
                                                   end
                                                  else
                                                   begin
                                                   si:=sf;
                                                   sf:=sf+sdt*strtofloat(text);
                                                   s:=sdt*strtofloat(text);
                                                   end;
                                                end;

          end;

     with tedit(findcomponent('edit'+inttostr(i+46))) do
          begin
          if ggg=1 then
          lam:=strtofloat(text)/g;
          end;

     with tcombobox(findcomponent('combobox'+inttostr(i))) do
          begin
               for j:=0 to 10 do
               if itemindex = j then
                  begin
                  repeat
                  control[inc]:=sdt*s;
                  inc:=inc+1;
                  tot[k,4]:=miscare(j,gi,gf,g,si,sf,s,phi);
                  tot[k,5]:=deriv_1(j,gi,gf,g,si,sf,s,phi,fin);
                  tot[k,6]:=deriv_2(j,gi,gf,g,si,sf,s,phi);
                  phi:=phi+0.1;
                  k:=k+1;
                  until phi >= gf ;   // nu cred ca este bine
                  end;
          end;
end;

//--------------------------
//    incheie calculul
//--------------------------

//-------------------------------------------
// calculul deplasari, vitezei si acceleratiei la elem. condus.

es1:=0;
es2:=0;

if form1.RadioGroup1.ItemIndex = 0 then     //tachet oscilant
begin
     if ((xa>=0) and (ya>=0)) then
         begin
         alfa1:=arccos((xa*xa+ya*ya+l3*l3-rb*rb)/(2*sqrt(xa*xa+ya*ya)*l3))+arcsin(ya/sqrt(xa*xa+ya*ya));
         alfa2:=-arccos((xa*xa+ya*ya+l3*l3-rb*rb)/(2*sqrt(xa*xa+ya*ya)*l3))+arcsin(ya/sqrt(xa*xa+ya*ya));
         if alfa2<0 then   alfa2:=2*pi+alfa2;
         end
         else
             if ((xa<=0) and (ya>=0)) then
                begin
                alfa1:=pi+arccos((xa*xa+ya*ya+l3*l3-rb*rb)/(2*sqrt(xa*xa+ya*ya)*l3))-arcsin(ya/sqrt(xa*xa+ya*ya));
                alfa2:=pi-arccos((xa*xa+ya*ya+l3*l3-rb*rb)/(2*sqrt(xa*xa+ya*ya)*l3))-arcsin(ya/sqrt(xa*xa+ya*ya));
                end
                else
                    if ((xa<=0) and (ya<=0)) then
                    begin
                    ya:=-ya;
                    alfa1:=pi+arccos((xa*xa+ya*ya+l3*l3-rb*rb)/(2*sqrt(xa*xa+ya*ya)*l3))+arcsin(ya/sqrt(xa*xa+ya*ya));
                    alfa2:=pi-arccos((xa*xa+ya*ya+l3*l3-rb*rb)/(2*sqrt(xa*xa+ya*ya)*l3))+arcsin(ya/sqrt(xa*xa+ya*ya));
                    ya:=-ya;
                    end
                    else
                        if ((xa>=0)  and (ya<=0)) then
                        begin
                        ya:=-ya;
                        alfa1:=2*pi+arccos((xa*xa+ya*ya+l3*l3-rb*rb)/(2*sqrt(xa*xa+ya*ya)*l3))-arcsin(ya/sqrt(xa*xa+ya*ya));
                        alfa2:=2*pi-arccos((xa*xa+ya*ya+l3*l3-rb*rb)/(2*sqrt(xa*xa+ya*ya)*l3))-arcsin(ya/sqrt(xa*xa+ya*ya));
                        ya:=-ya;
                        if (alfa1>=(2*pi)) then
                           alfa1:=-2*pi+alfa1;
                        end;

  //  form5.memo1.Lines.Add('alfa1 = '+floattostr(alfa1*180/pi));
  //  form5.memo1.Lines.Add('alfa2 = '+floattostr(alfa2*180/pi));

 {  if (alfa1 >=(2*pi))  then alfa1:=-2*pi+alfa1;
   if (alfa1 < 0 ) then alfa1:=2*pi+alfa1;
   if (alfa2 >=(2*pi))  then alfa2:=-2*pi+alfa2;
   if (alfa2 < 0 ) then alfa2:=2*pi+alfa2; }

     if form2.RadioGroup1.ItemIndex=0 then    //inseriat cu nimic
        begin
             ii:=7;
             iii:=9;
             iiii:=11;
            for k:=1 to 3600 do
            begin
            al:=1;
            tot[k,7]:=tot[k,4]+alfa1;
            tot[k,9]:=tot[k,5];
            tot[k,11]:=tot[k,6];
            profil_cama1(k);
            end;

        end;

     if form2.RadioGroup1.ItemIndex=1 then   //  inseriat cu manivela piston
        begin

             for k:=1 to 3600 do
             begin
             a:=-2*l3p*(xd+tot[k,4]);
             b:=-2*l3p*yd;
             c:=power((xd+tot[k,4]),2)+yd*yd+l3p*l3p-l4*l4;
             tot[k,7]:=2*arctan((b+sqrt(a*a+b*b-c*c))/(a-c))-delta*pi/180;
             if tot[1,7] < 0  then
             begin
             inter1:=1;
             end;

             tot[k,7]:=inter1*2*pi+tot[k,7];
             tot[k,9]:=(l3p*tot[k,5]*cos(tot[k,7]+delta*pi/180)-tot[k,5]*(xd+tot[k,4]))/( l3p*(xd+tot[k,4])*sin(tot[k,7]+delta*pi/180)-l3p*yd*cos(tot[k,7]+delta*pi/180));
             tot[k,11]:=(tot[k,6]*(l3p*cos(tot[k,7]+delta*pi/180)-xd-tot[k,4])-2*l3p*tot[k,9]*tot[k,5]*sin(tot[k,7]+delta*pi/180)-l3p*tot[k,9]*tot[k,9]*((xd+tot[k,4])*cos(tot[k,7]+delta*pi/180)+yd*sin(tot[k,7]+delta*pi/180))-tot[k,5]*tot[k,5])/(l3p*((xd+tot[k,4])*sin(tot[k,7]+delta*pi/180)-yd*cos(tot[k,7]+delta*pi/180)));

             tot[k,8]:=2*arctan((b-sqrt(a*a+b*b-c*c))/(a-c))-delta*pi/180;
             if tot[1,8] < 0  then
             begin
             inter2:=1;
             end;
             tot[k,8]:=inter2*2*pi+tot[k,8];
             tot[k,10]:=(l3p*tot[k,5]*cos(tot[k,8]+delta*pi/180)-tot[k,5]*(xd+tot[k,4]))/( l3p*(xd+tot[k,4])*sin(tot[k,8]+delta*pi/180)-l3p*yd*cos(tot[k,8]+delta*pi/180));
             tot[k,12]:=(tot[k,6]*(l3p*cos(tot[k,8]+delta*pi/180)-xd-tot[k,4])-2*l3p*tot[k,10]*tot[k,5]*sin(tot[k,8]+delta*pi/180)-l3p*tot[k,10]*tot[k,10]*((xd+tot[k,4])*cos(tot[k,8]+delta*pi/180)+yd*sin(tot[k,8]+delta*pi/180))-tot[k,5]*tot[k,5])/(l3p*((xd+tot[k,4])*sin(tot[k,8]+delta*pi/180)-yd*cos(tot[k,8]+delta*pi/180)));
             end;

             if tot[1,7]<0 then begin
                                for i:=1 to 3600 do tot[i,7]:=2*pi+tot[i,7];

                                end;
             if tot[1,8]<0 then begin
                                for i:=1 to 3600 do tot[i,8]:=2*pi+tot[i,8];

                                end;

             if ((alfa1-5*pi/180)<=tot[1,7]) and (tot[1,7]<=(alfa1+5*pi/180)) then

             for i:=1 to 3600 do
             begin
             al:=1;
             ii:=7;
             iii:=9;
             iiii:=11;
             profil_cama1(i);
             end;

             if ((alfa2-5*pi/180)<=tot[1,7]) and (tot[1,7]<=(alfa2+5*pi/180)) then

             for i:=1 to 3600 do
             begin
             al:=2;
             ii:=7;
             iii:=9;
             iiii:=11;
             profil_cama1(i);
             end;

             if ((alfa1-5*pi/180)<=tot[1,8]) and (tot[1,8]<=(alfa1+5*pi/180))  then

             for i:=1 to 3600 do
             begin
             al:=1;
             ii:=8;
             iii:=10;
             iiii:=12;
             profil_cama1(i);
             end;

             if ((alfa2-5*pi/180)<=tot[1,8]) and (tot[1,8]<=(alfa2+5*pi/180))  then

             for i:=1 to 3600 do
             begin
             al:=2;
             ii:=8;
             iii:=10;
             iiii:=12;
             profil_cama1(i);
             end;
        //     form5.memo1.Lines.Add('1,7 = '+floattostr(tot[1,7]*180/pi));
        //     form5.memo1.Lines.Add('1,8 = '+floattostr(tot[1,8]*180/pi));

        end;
     if form2.RadioGroup1.ItemIndex=2 then    // inseriat cu patrulater articulat
        begin
             x:=xs-xd;
             y:=ys-yd;

             if (x < 0) and (y <= 0) then
             begin
             y:=-y;
             unghi:=arcsin(y/(sqrt(x*x+y*y)))+pi;
             y:=-y;
             end
             else
                 if (x <= 0) and (y > 0) then
                 begin
                 x:=-x;
                 unghi:=arcsin(x/(sqrt(x*x+y*y)))+pi/2;
                 x:=-x;
                 end
                 else
                     if (x > 0) and (y>=0) then
                     unghi:=arcsin(y/sqrt(x*x+y*y))
                     else
                         if (x >= 0) and (y < 0) then
                         unghi:=arcsin(x/sqrt(x*x+y*y))+3*pi/2;

           for k:=1 to 3600 do
           begin
           a:=-2*l3p*xd-2*l3p*l5*cos(unghi+tot[k,4]);
           b:=-2*l3p*(yd+l5*sin(unghi+tot[k,4]));
           c:=xd*xd+yd*yd+l3p*l3p-l4*l4+l5*l5+2*l5*(xd*cos(unghi+tot[k,4])+yd*sin(unghi+tot[k,4]));

           tot[k,7]:=2*arctan((b+sqrt(a*a+b*b-c*c))/(a-c))-delta*pi/180;
           if (tot[1,7] < 0 ) then
              begin
              inter1:=1;
              end;
           tot[k,7]:=inter1*2*pi+tot[k,7];
           tot[k,9]:=(2*l3p*l5*cos(unghi+tot[k,4])*tot[k,5]*sin(tot[k,7]+delta*pi/180)-2*l3p*l5*sin(unghi+tot[k,4])*tot[k,5]*cos(tot[k,7]+delta*pi/180)-2*l5*tot[k,5]*(yd*cos(unghi+tot[k,4])-xd*sin(unghi+tot[k,4])))/(2*l3p*(xd+l5*cos(unghi+tot[k,4]))*sin(tot[k,7]+delta*pi/180)-2*l3p*(yd+l5*sin(unghi+tot[k,4]))*cos(tot[k,7]+delta*pi/180));
           tot[k,11]:=(l3p*l5*cos(unghi+tot[k,4])*tot[k,5]*tot[k,5]*cos(tot[k,7]+delta*pi/180)+l3p*l5*sin(unghi+tot[k,4])*tot[k,6]*cos(tot[k,7]+delta*pi/180)-l3p*l5*tot[k,5]*sin(unghi+tot[k,4])*sin(tot[k,7]+delta*pi/180)*tot[k,9]-l3p*l5*sin(unghi+tot[k,4])*tot[k,5]*sin(tot[k,7]+delta*pi/180)*tot[k,9]+l3p*(xd+l5*cos(unghi+tot[k,4]))*cos(tot[k,7]+delta*pi/180)*tot[k,9]*tot[k,9]+l3p*l5*sin(unghi+tot[k,4])*tot[k,5]*tot[k,5]*sin(tot[k,7]+delta*pi/180)-l3p*l5*cos(unghi+tot[k,4])*tot[k,6]*sin(tot[k,7]+delta*pi/180)-2*l3p*l5*cos(unghi+tot[k,4])*tot[k,5]*cos(tot[k,7]+delta*pi/180)*tot[k,9]+l3p*(yd+l5*sin(unghi+tot[k,4]))*sin(tot[k,7]+delta*pi/180)*tot[k,9]*tot[k,9]+l5*tot[k,6]*(yd*cos(unghi+tot[k,4])-xd*sin(unghi+tot[k,4]))-l5*tot[k,5]*tot[k,5]*(yd*sin(unghi+tot[k,4])+xd*cos(unghi+tot[k,4])))/(l3p*(yd+l5*sin(unghi+tot[k,4]))*cos(tot[k,7]+delta*pi/180)-l3p*(xd+l5*cos(unghi+tot[k,4]))*sin(tot[k,7]+delta*pi/180));

           tot[k,8]:=2*arctan((b-sqrt(a*a+b*b-c*c))/(a-c))-delta*pi/180;
           if (tot[1,8] < 0)  then
              begin
              inter2:=1;
              end;
           tot[k,8]:=inter2*2*pi+tot[k,8];
           tot[k,10]:=(2*l3p*l5*cos(unghi+tot[k,4])*tot[k,5]*sin(tot[k,8]+delta*pi/180)-2*l3p*l5*sin(unghi+tot[k,4])*tot[k,5]*cos(tot[k,8]+delta*pi/180)-2*l5*tot[k,5]*(yd*cos(unghi+tot[k,4])-xd*sin(unghi+tot[k,4])))/(2*l3p*(xd+l5*cos(unghi+tot[k,4]))*sin(tot[k,8]+delta*pi/180)-2*l3p*(yd+l5*sin(unghi+tot[k,4]))*cos(tot[k,8]+delta*pi/180));
           tot[k,12]:=(l3p*l5*cos(unghi+tot[k,4])*tot[k,5]*tot[k,5]*cos(tot[k,8]+delta*pi/180)+l3p*l5*sin(unghi+tot[k,4])*tot[k,6]*cos(tot[k,8]+delta*pi/180)-l3p*l5*tot[k,5]*sin(unghi+tot[k,4])*sin(tot[k,8]+delta*pi/180)*tot[k,10]-l3p*l5*sin(unghi+tot[k,4])*tot[k,5]*sin(tot[k,8]+delta*pi/180)*tot[k,10]+l3p*(xd+l5*cos(unghi+tot[k,4]))*cos(tot[k,8]+delta*pi/180)*tot[k,10]*tot[k,10]+l3p*l5*sin(unghi+tot[k,4])*tot[k,5]*tot[k,5]*sin(tot[k,8]+delta*pi/180)-l3p*l5*cos(unghi+tot[k,4])*tot[k,6]*sin(tot[k,8]+delta*pi/180)-2*l3p*l5*cos(unghi+tot[k,4])*tot[k,5]*cos(tot[k,8]+delta*pi/180)*tot[k,10]+l3p*(yd+l5*sin(unghi+tot[k,4]))*sin(tot[k,8]+delta*pi/180)*tot[k,10]*tot[k,10]+l5*tot[k,6]*(yd*cos(unghi+tot[k,4])-xd*sin(unghi+tot[k,4]))-l5*tot[k,5]*tot[k,5]*(yd*sin(unghi+tot[k,4])+xd*cos(unghi+tot[k,4])))/(l3p*(yd+l5*sin(unghi+tot[k,4]))*cos(tot[k,8]+delta*pi/180)-l3p*(xd+l5*cos(unghi+tot[k,4]))*sin(tot[k,8]+delta*pi/180));

           end;

             if tot[1,7]<0 then begin
                                for i:=1 to 3600 do tot[i,7]:=2*pi+tot[i,7];
                                end;
             if tot[1,8]<0 then begin
                                for i:=1 to 3600 do tot[i,8]:=2*pi+tot[i,8];
                                end;

           if ((alfa1-10*pi/180)<=tot[1,7]) and (tot[1,7]<=(alfa1+10*pi/180)) then

              for i:=1 to 3600 do
             begin
             al:=1;
             ii:=7;
             iii:=9;
             iiii:=11;
             profil_cama1(i);
             end;

             if ((alfa2-10*pi/180)<=tot[1,7]) and (tot[1,7]<=(alfa2+10*pi/180)) then
                for i:=1 to 3600 do
             begin
             al:=2;
             ii:=7;
             iii:=9;
             iiii:=11;
             profil_cama1(i);
             end;

           if ((alfa1-10*pi/180)<=tot[1,8]) and (tot[1,8]<=(alfa1+10*pi/180)) then
               for i:=1 to 3600 do
             begin
             al:=1;
             ii:=8;
             iii:=10;
             iiii:=12;
             profil_cama1(i);
             end;

           if ((alfa2-10*pi/180)<=tot[1,8]) and (tot[1,8]<=(alfa2+10*pi/180)) then
               for i:=1 to 3600 do
             begin
             al:=2;
             ii:=8;
             iii:=10;
             iiii:=12;
             profil_cama1(i);
             end;

        end;

   if form2.RadioGroup1.ItemIndex = 3 then   // inseriat cu culisa oscilanta
        begin
             for k:=1 to 3600 do
             begin
             a:=l3+l3p*cos(delta*pi/180);
             b:=-l3p*sin(delta*pi/180);
             c:=-x1-tot[k,4];
             tot[k,7]:=2*arctan((b+sqrt(a*a+b*b-c*c))/(a-c));

             if tot[1,7] < 0 then
             begin
             inter1:=1;
             end;
             tot[k,7]:=inter1*2*pi+tot[k,7];
             tot[k,9]:=-(tot[k,5])/((l3+l3p*cos(delta*pi/180))*sin(tot[k,7])+l3p*sin(delta*pi/180)*cos(tot[k,7]));
             tot[k,11]:=-((l3+l3p*cos(delta*pi/180))*cos(tot[k,7])*tot[k,9]*tot[k,9]-l3p*sin(delta*pi/180)*sin(tot[k,7])*tot[k,9]*tot[k,9]+tot[k,6])/((l3+l3p*cos(delta*pi/180))*sin(tot[k,7])+l3p*sin(delta*pi/180)*cos(tot[k,7]));

             tot[k,8]:=2*arctan((b-sqrt(a*a+b*b-c*c))/(a-c));
             if tot[1,8]<0 then
             begin
             inter2:=1;
             end;
             tot[k,8]:=inter2*2*pi+tot[k,8];
             tot[k,10]:=-(tot[k,5])/((l3+l3p*cos(delta*pi/180))*sin(tot[k,8])+l3p*sin(delta*pi/180)*cos(tot[k,8]));
             tot[k,12]:=-((l3+l3p*cos(delta*pi/180))*cos(tot[k,8])*tot[k,10]*tot[k,10]-l3p*sin(delta*pi/180)*sin(tot[k,8])*tot[k,10]*tot[k,10]+tot[k,6])/((l3+l3p*cos(delta*pi/180))*sin(tot[k,8])+l3p*sin(delta*pi/180)*cos(tot[k,8]));
             end;

             if tot[1,7]<0 then begin
                                for i:=1 to 3600 do tot[i,7]:=2*pi+tot[i,7];
                                end;
             if tot[1,8]<0 then begin
                                for i:=1 to 3600 do tot[i,8]:=2*pi+tot[i,8];
                                end;

           if ((alfa1-10*pi/180)<=tot[1,7]) and (tot[1,7]<=(alfa1+10*pi/180)) then
             begin

              for i:=1 to 3600 do
             begin
             al:=1;
             ii:=7;
             iii:=9;
             iiii:=11;
             profil_cama1(i);
             end;
             end;

             if ((alfa2-10*pi/180)<=tot[1,7]) and (tot[1,7]<=(alfa2+10*pi/180)) then
                begin

                for i:=1 to 3600 do
             begin
             al:=2;
             ii:=7;
             iii:=9;
             iiii:=11;
             profil_cama1(i);
             end;
             end;

           if ((alfa1-10*pi/180)<=tot[1,8]) and (tot[1,8]<=(alfa1+10*pi/180)) then
               begin

               for i:=1 to 3600 do
             begin
             al:=1;
             ii:=8;
             iii:=10;
             iiii:=12;
             profil_cama1(i);
             end;
             end;

           if ((alfa2-10*pi/180)<=tot[1,8]) and (tot[1,8]<=(alfa2+10*pi/180)) then
                 begin

               for i:=1 to 3600 do
             begin
             al:=2;
             ii:=8;
             iii:=10;
             iiii:=12;
             profil_cama1(i);
             end;
             end;

        end;
end // de la then principal
else      // tachet in translatie
begin
ii:=7;
iii:=9;
iiii:=11;
if form3.RadioGroup1.ItemIndex=0 then    // insetiat cu nimic
   begin
        for k:=1 to 3600 do
        begin
        tot[k,7]:=tot[k,4]+x1;
        tot[k,9]:=tot[k,5];
        tot[k,11]:=tot[k,6];
        end;
        for i:=1 to 3600 do
        begin
          profil_cama1(i);
        end;
   end;

if form3.RadioGroup1.ItemIndex=1 then      // inseriat cu dublu piston
   begin
            if x1 < yd then
              es1:=-1
              else
              es1:=1;

        for k:=1 to 3600 do
            begin
            tot[k,7]:=yd+es1*sqrt(l4*l4-(xd+tot[k,4])*(xd+tot[k,4]));
            tot[k,9]:=-(tot[k,4]*tot[k,5])/(tot[k,7]-yd);
            tot[k,11]:=-((tot[k,5]*tot[k,5]+tot[k,4]*tot[k,6])*(tot[k,7]-yd)-tot[k,4]*tot[k,5]*tot[k,9])/(power((tot[k,7]-yd),2));
            end;

        for i:=1 to 3600 do
            begin
            profil_cama1(i);
            end ;
   end;

if form3.RadioGroup1.ItemIndex=2 then     // inseriat cu manivela piston
   begin
        if x1<(l5*sin(delta*pi/180)+yd) then
            es1:=-1
        else
            es1:=1;

        for k:=1 to 3600 do
            begin
            a:=1;
            b:=-2*yd-2*l5*sin(delta*pi/180+tot[k,4]);
            c:=xd*xd+yd*yd+l5*l5+2*xd*l5*cos(delta*pi/180+tot[k,4])+2*yd*l5*sin(delta*pi/180+tot[k,4])-l4*l4;

            tot[k,7]:=(-b+es1*sqrt(b*b-4*a*c))/(2*a);
            tot[k,9]:=(l5*cos(delta*pi/180+tot[k,4])*tot[k,5]*tot[k,7]+xd*l5*sin(delta*pi/180+tot[k,4])*tot[k,5]-yd*l5*cos(delta*pi/180+tot[k,4])*tot[k,5])/(tot[k,7]-yd-l5*sin(delta*pi/180+tot[k,4]));
            tot[k,11]:=(l5*cos(delta*pi/180+tot[k,4])*tot[k,6]*(tot[k,7]-yd)+l5*sin(delta*pi/180+tot[k,4])*tot[k,5]*tot[k,5]*(yd-tot[k,7])+2*l5*cos(delta*pi/180+tot[k,4])*tot[k,5]*tot[k,7]-tot[k,7]*tot[k,7]+xd*l5*cos(delta*pi/180+tot[k,4])*tot[k,5]*tot[k,5]+xd*l5*sin(delta*pi/180+tot[k,4])*tot[k,6])/(tot[k,7]-yd-l5*sin(delta*pi/180+tot[k,4]));
            end;

        for i:=1 to 3600 do
            begin
            profil_cama1(i);
            end;
   end;

end;  // de la else principal

//------------------------------------
//     incheie calcului
//------------------------------------


//----------------------------
//        afisare
control1:=0;
control2:=0;
control3:=0;
ac:=true;

for i:=1 to 3600 do
begin
if tot[i,31]<0
then
   begin
   if (ro > (-tot[i,31])) then
                              begin
                              control1:=1 ;
                              form5.Series7.Add(tot[i,31],' ',clred);
                              end
                          else
                              begin
                              form5.Series7.Add(tot[i,31],' ',clblue);
                              ac:=true;
                              end;
   end
else
   begin
   if  (ro > tot[i,31]) then
                            begin
                            control1:=1 ;
                            form5.Series7.Add(tot[i,31],' ',clred);
                            end
                        else
                            begin
                            form5.Series7.Add(tot[i,31],' ',clblue);
                            ac:=true;
                            end;


   end;

end;
if control1=1 then
begin
form5.Label1.Visible:=true;
form5.Label1.Color:=clred;
form5.Label1.Caption:='ro_min > ro';
end;
for i:=1 to 3600 do
begin
if control[i] < 0 then
   begin
   if (niu_c > (tot[i,32]*180/pi)) then
                                       begin
                                       control2:=1;
                                       form5.Series8.Add(tot[i,32]*180/pi,' ',clred);
                                       end
                                   else
                                       begin
                                       form5.Series8.Add(tot[i,32]*180/pi,' ',clblue);
                                       end;
   end
else
    begin
            if (niu_u > (tot[i,32]*180/pi)) then
                                                begin
                                                control3:=1;
                                                 form5.Series8.Add(tot[i,32]*180/pi,' ',clred);
                                                end
                                            else
                                                begin
                                                 form5.Series8.Add(tot[i,32]*180/pi,' ',clblue);
                                                end;
    end;

end;             
if ((control2=1) and (control3=1)) then
begin
form5.Label2.Visible:=true;
form5.Label2.Color:=clred;
form5.Label2.Caption:='miu_u<miu und miu_c<miu';
end
else
begin
if control3=1 then
   begin
   form5.Label2.Visible:=true;
   form5.Label2.Color:=clred;
   form5.Label2.Caption:='miu_u>miu';
   end;
if control2=1 then
   begin
   form5.Label2.Visible:=true;
   form5.Label2.Color:=clred;
   form5.Label2.Caption:='miu_c<miu';
   end;
end;

min:=0;
max:=0;
for i:=1 to 3600 do
begin
if (min > tot[i,15]) then  min:=tot[i,15];
if (max < tot[i,15]) then  max:=tot[i,15];
if (min > tot[i,23]) then  min:=tot[i,23];
if (max < tot[i,23]) then  max:=tot[i,23];
if (min > tot[i,25]) then  min:=tot[i,25];
if (max < tot[i,25]) then  max:=tot[i,25];
if (min > tot[i,27]) then  min:=tot[i,27];
if (max < tot[i,27]) then  max:=tot[i,27];
if (min > tot[i,29]) then  min:=tot[i,29];
if (max < tot[i,29]) then  max:=tot[i,29];

if (min > tot[i,16]) then  min:=tot[i,16];
if (max < tot[i,16]) then  max:=tot[i,16];
if (min > tot[i,24]) then  min:=tot[i,24];
if (max < tot[i,24]) then  max:=tot[i,24];
if (min > tot[i,26]) then  min:=tot[i,26];
if (max < tot[i,26]) then  max:=tot[i,26];
if (min > tot[i,28]) then  min:=tot[i,28];
if (max < tot[i,28]) then  max:=tot[i,28];
if (min > tot[i,30]) then  min:=tot[i,30];
if (max < tot[i,30]) then  max:=tot[i,30];
end;

//------------------------------------------------------
//      inceput calcul pt. animatie, pt. profil teoretic
maxxx:=0;
for i:=1 to 3600 do
begin

anim[i,1]:=sqrt((tot[i,15]-xa)*(tot[i,15]-xa)+(tot[i,16]-ya)*(tot[i,16]-ya));
if (((tot[i,15]-xa)>= 0) and ((tot[i,16]-ya)>=0)) then
   begin
   anim[i,2]:=arcsin((tot[i,16]-ya)/anim[i,1]);
   end
   else
       if (((tot[i,15]-xa)<= 0) and ((tot[i,16]-ya)>=0)) then
          begin
          anim[i,2]:=pi-arcsin((tot[i,16]-ya)/anim[i,1]);
          end
          else
              if (((tot[i,15]-xa)<=0) and ((tot[i,16]-ya)<=0)) then
                 begin
                 anim[i,2]:=pi+arcsin(-(tot[i,16]-ya)/anim[i,1]);
                 end
                 else
                     if (((tot[i,15]-xa)>=0) and ((tot[i,16]-ya)<=0)) then
                        begin
                        anim[i,2]:=2*pi-arcsin(-(tot[i,16]-ya)/anim[i,1]);
                        end;
if anim[i,1]> maxxx then maxxx:=anim[i,1] ;
//anim[i,2]:=arctan((tot[i,16]-ya)/(tot[i,15]-xa));
//form5.memo1.Lines.Add(inttostr(i)+'  '+floattostr(anim[i,2]*180/pi));

end;
incun:=0;
for j:=3 to 39 do
begin
     for i:=1 to 3600 do
     begin
     anim[i,j]:=anim[i,1]*cos(anim[i,2]+incun*pi/180);
     anim[i,j+37]:=anim[i,1]*sin(anim[i,2]+incun*pi/180);
     end;
     incun:=incun+src*10  ;
end;
//    sfatsit sfarsit calcul pt. animatie, pt profil teoretic
//--------------------------------------------------------

//---------------------------------------------------------
//   inceput calcul animatie pt cama reala
for i:=1 to 3600 do
begin
anir[i,1]:=sqrt((tot[i,23]-xa)*(tot[i,23]-xa)+(tot[i,24]-ya)*(tot[i,24]-ya));

//anir[i,1]:= anim[i,1]-r;

if (((tot[i,23]-xa)>= 0) and ((tot[i,24]-ya)>=0)) then
   begin
   anir[i,2]:=arcsin((tot[i,24]-ya)/anir[i,1]);
   end
   else
       if (((tot[i,23]-xa)<= 0) and ((tot[i,24]-ya)>=0)) then
          begin
          anir[i,2]:=pi-arcsin((tot[i,24]-ya)/anir[i,1]);
          end
          else
              if (((tot[i,23]-xa)<=0) and ((tot[i,24]-ya)<=0)) then
                 begin
                 anir[i,2]:=pi+arcsin(-(tot[i,24]-ya)/anir[i,1]);
                 end
                 else
                     if (((tot[i,23]-xa)>=0) and ((tot[i,24]-ya)<=0)) then
                        begin
                        anir[i,2]:=2*pi-arcsin(-(tot[i,24]-ya)/anir[i,1]);
                        end;
//if anim[i,1]> maxxx then maxxx:=anim[i,1] ;
//anim[i,2]:=arctan((tot[i,16]-ya)/(tot[i,15]-xa));
//form5.memo1.Lines.Add(inttostr(i)+'  '+floattostr(anim[i,2]*180/pi));


//anir[i,2]:= anim[i,2];    asta am anulatooooooooooooooooooooooooo
end;

incun:=0;
for j:=3 to 39 do
begin
     for i:=1 to 3600 do
     begin
     anir[i,j]:=anir[i,1]*cos(anir[i,2]+incun*pi/180);
     anir[i,j+37]:=anir[i,1]*sin(anir[i,2]+incun*pi/180);
     end;
     incun:=incun+src*10  ;
end;

//   sf. calcul pt cama reala
//----------------------------------------------------------

//----------------------------------------------------------
// calculul pt. saiba mica si saiba mare

for i:=1 to 3600 do
begin
saiba[i,1]:=cercmic*cos((i/2)*(pi/180));
saiba[i,2]:=cercmic*sin((i/2)*(pi/180));
saiba[i,3]:=cercmare*cos((i/2)*(pi/180));
saiba[i,4]:=cercmare*sin((i/2)*(pi/180));

end;


// sf. calcul pt saiba mica si saiba mare
//----------------------------------------------------------



//i:=3;
min:=round(min);
max:=round(max);
//if min<0 then min:=-min;
//if max> min then
//begin
form5.Series20.Clear;
form5.Series20.AddXY(min,min,' ',clsilver);
form5.Series20.AddXY(max,max,' ',clsilver);
{end
else
begin
form5.Series20.Clear;
form5.Series20.AddXY(-min-xa,-min-ya,' ',clsilver);
form5.Series20.AddXY(min+xa,min+ya,' ',clsilver);
end;
}
form5.visible:=true;
form4.Visible:=false;



end;

procedure TForm4.Button8Click(Sender: TObject);
var sss:string;
begin

form7.Visible:=false;
form7.Image1.Picture.CleanupInstance;
if form1.RadioGroup1.ItemIndex=0 then
begin
     if form2.RadioGroup1.ItemIndex=0 then
        begin
             if form6.RadioGroup1.ItemIndex=0 then
                begin
                sss:='11osc. simpla.bmp';
                end;
             if form6.RadioGroup1.ItemIndex=1 then
                begin
                sss:='12osc. cama dubla.bmp';
                end;
             if form6.RadioGroup1.ItemIndex=2 then
                begin
                sss:='13osc. cama cu canal.bmp';
                end;
             if form6.RadioGroup1.ItemIndex=3 then
                begin
                sss:='14osc. cama cu nervuri.bmp';
                end;

        end;
     if form2.RadioGroup1.ItemIndex=1 then
        begin
             if form6.RadioGroup1.ItemIndex=0 then
                begin
                sss:='21osc. cu piston simpla.bmp';
                end;
             if form6.RadioGroup1.ItemIndex=1 then
                begin
                sss:='22osc. cu piston cama dubla.bmp';
                end;
             if form6.RadioGroup1.ItemIndex=2 then
                begin
                sss:='23osc. cu piston cama cu canal.bmp';
                end;
             if form6.RadioGroup1.ItemIndex=3 then
                begin
                sss:='24osc. cu piston cama cu nervura.bmp';
                end;

        end;
     if form2.RadioGroup1.ItemIndex=2 then
        begin
             if form6.RadioGroup1.ItemIndex=0 then
                begin
                sss:='31osc. cu patrulater simpla.bmp';
                end;
             if form6.RadioGroup1.ItemIndex=1 then
                begin
                sss:='32osc. cu patrulater cama dubla.bmp';
                end;
             if form6.RadioGroup1.ItemIndex=2 then
                begin
                sss:='33osc. cu patrulater cama cu canal.bmp';
                end;
             if form6.RadioGroup1.ItemIndex=3 then
                begin
                sss:='34osc. cu patrulater cama cu nervura.bmp';
                end;

        end;
     if form2.RadioGroup1.ItemIndex=3 then
        begin
             if form6.RadioGroup1.ItemIndex=0 then
                begin
                sss:='41osc. cu culisa simpla.bmp';
                end;
             if form6.RadioGroup1.ItemIndex=1 then
                begin
                sss:='42osc. cu culisa cama dubla.bmp';
                end;
             if form6.RadioGroup1.ItemIndex=2 then
                begin
                sss:='43osc. cu culisa cama cu canal.bmp';
                end;
             if form6.RadioGroup1.ItemIndex=3 then
                begin
                sss:='44osc. cu culisa cama cu nervuri.bmp';
                end;

        end;

end  //end de la then-ul principal
else
begin
    if form3.RadioGroup1.ItemIndex=0 then
       begin
            if form6.RadioGroup2.ItemIndex=0 then
                begin
                sss:='51tran. simpla.bmp';
                end;
            if form6.RadioGroup2.ItemIndex=1 then
                begin
                sss:='52tran. cu cama dubla.bmp';
                end;
            if form6.RadioGroup2.ItemIndex=2 then
                begin
                sss:='53tran. cu cama cu canal.bmp';
                end;
            if form6.RadioGroup2.ItemIndex=3 then
                begin
                sss:='54tran. cu nervura.bmp';
                end;

       end;
    if form3.RadioGroup1.ItemIndex=1 then
       begin
            if form6.RadioGroup2.ItemIndex=0 then
                begin
                sss:='61tran. cu dublu piston simpla.bmp';
                end;
            if form6.RadioGroup2.ItemIndex=1 then
                begin
                sss:='62tran. cu dublu piston cama dubla.bmp';
                end;
            if form6.RadioGroup2.ItemIndex=2 then
                begin
                sss:='63tran. cu dublu piston cama cu canal.bmp';
                end;
            if form6.RadioGroup2.ItemIndex=3 then
                begin
                sss:='64tran. cu dublu piston cama cu nervura.bmp';
                end;

       end;
    if form3.RadioGroup1.ItemIndex=2 then
       begin
            if form6.RadioGroup2.ItemIndex=0 then
                begin
                sss:='71tran. cu manivela piston simpla.bmp';
                end;
            if form6.RadioGroup2.ItemIndex=1 then
                begin
                sss:='72tran. cu manivela piston cu cama dubla.bmp';
                end;
            if form6.RadioGroup2.ItemIndex=2 then
                begin
                sss:='73tran. cu manivela piston cu cama cu canal.bmp';
                end;
            if form6.RadioGroup2.ItemIndex=3 then
                begin
                sss:='74tran. cu manivela piston cu nervura.bmp';
                end;

       end;

end; // end de la else-ul principal
form7.visible:=true;
//form7.Caption:=sss;
form7.Image1.Picture.LoadFromFile(sss);
form7.ClientHeight:=form7.Image1.ClientHeight;
form7.ClientWidth:=form7.Image1.ClientWidth;
{form7.Visible:=false;
MessageDlg('Selectati desenul corespunzator alegerilor facute', mtInformation,[mbOk], 0);
if form4.openpicturedialog1.Execute then
form7.Image1.Picture.LoadFromFile(form4.openpicturedialog1.filename);
form7.visible:=true;
form7.ClientHeight:=form7.Image1.ClientHeight;
form7.ClientWidth:=form7.Image1.ClientWidth;

ce a scris vili in form1
s:=form1.FileListBox1.FileName;
form1.Image3.Picture.LoadFromFile(s);
form1.Caption:=( form1.FileListBox1.Items.Strings[3]);
}

end;

procedure TForm4.Button9Click(Sender: TObject);
begin
form4.ComboBox14.Clear;
form4.ComboBox14.Items.Add(' ');
form4.ComboBox14.Items.Add(inttostr(form1.RadioGroup1.ItemIndex));
form4.ComboBox14.Items.Add(inttostr(form2.RadioGroup1.ItemIndex));
form4.ComboBox14.Items.Add(inttostr(form3.RadioGroup1.ItemIndex));
form4.ComboBox14.Items.Add(inttostr(form6.RadioGroup1.ItemIndex));
form4.ComboBox14.Items.Add(inttostr(form6.RadioGroup2.ItemIndex));
form4.ComboBox14.Items.Add(inttostr(form4.ComboBox13.ItemIndex));
form4.ComboBox14.Items.Add(inttostr(form4.ComboBox1.ItemIndex));
form4.ComboBox14.Items.Add(inttostr(form4.ComboBox2.ItemIndex));
form4.ComboBox14.Items.Add(inttostr(form4.ComboBox3.ItemIndex));
form4.ComboBox14.Items.Add(inttostr(form4.ComboBox4.ItemIndex));
form4.ComboBox14.Items.Add(inttostr(form4.ComboBox5.ItemIndex));
form4.ComboBox14.Items.Add(inttostr(form4.ComboBox6.ItemIndex));
form4.ComboBox14.Items.Add(inttostr(form4.ComboBox7.ItemIndex));
form4.ComboBox14.Items.Add(inttostr(form4.ComboBox8.ItemIndex));
form4.ComboBox14.Items.Add(inttostr(form4.ComboBox9.ItemIndex));
form4.ComboBox14.Items.Add(inttostr(form4.ComboBox10.ItemIndex));
form4.ComboBox14.Items.Add(inttostr(form4.ComboBox11.ItemIndex));
form4.ComboBox14.Items.Add(inttostr(form4.ComboBox12.ItemIndex));
form4.ComboBox14.Items.Add(form4.Edit1.Text);
form4.ComboBox14.Items.Add(form4.Edit2.Text);
form4.ComboBox14.Items.Add(form4.Edit3.Text);
form4.ComboBox14.Items.Add(form4.Edit4.Text);
form4.ComboBox14.Items.Add(form4.Edit5.Text);
form4.ComboBox14.Items.Add(form4.Edit6.Text);
form4.ComboBox14.Items.Add(form4.Edit7.Text);
form4.ComboBox14.Items.Add(form4.Edit8.Text);
form4.ComboBox14.Items.Add(form4.Edit9.Text);
form4.ComboBox14.Items.Add(form4.Edit10.Text);
form4.ComboBox14.Items.Add(form4.Edit11.Text);
form4.ComboBox14.Items.Add(form4.Edit12.Text);
form4.ComboBox14.Items.Add(form4.Edit13.Text);
form4.ComboBox14.Items.Add(form4.Edit14.Text);
form4.ComboBox14.Items.Add(form4.Edit15.Text);
form4.ComboBox14.Items.Add(form4.Edit16.Text);
form4.ComboBox14.Items.Add(form4.Edit17.Text);
form4.ComboBox14.Items.Add(form4.Edit18.Text);
form4.ComboBox14.Items.Add(form4.Edit19.Text);
form4.ComboBox14.Items.Add(form4.Edit20.Text);
form4.ComboBox14.Items.Add(form4.Edit21.Text);
form4.ComboBox14.Items.Add(form4.Edit22.Text);
form4.ComboBox14.Items.Add(form4.Edit23.Text);
form4.ComboBox14.Items.Add(form4.Edit24.Text);
form4.ComboBox14.Items.Add(form4.Edit47.Text);
form4.ComboBox14.Items.Add(form4.Edit48.Text);
form4.ComboBox14.Items.Add(form4.Edit49.Text);
form4.ComboBox14.Items.Add(form4.Edit50.Text);
form4.ComboBox14.Items.Add(form4.Edit51.Text);
form4.ComboBox14.Items.Add(form4.Edit52.Text);
form4.ComboBox14.Items.Add(form4.Edit53.Text);
form4.ComboBox14.Items.Add(form4.Edit54.Text);
form4.ComboBox14.Items.Add(form4.Edit55.Text);
form4.ComboBox14.Items.Add(form4.Edit56.Text);
form4.ComboBox14.Items.Add(form4.Edit57.Text);
form4.ComboBox14.Items.Add(form4.Edit58.Text);
form4.ComboBox14.Items.Add(form4.Edit25.Text);
form4.ComboBox14.Items.Add(form4.Edit26.Text);
form4.ComboBox14.Items.Add(form4.Edit27.Text);
form4.ComboBox14.Items.Add(form4.Edit28.Text);
form4.ComboBox14.Items.Add(form4.Edit29.Text);
form4.ComboBox14.Items.Add(form4.Edit30.Text);
form4.ComboBox14.Items.Add(form4.Edit31.Text);
form4.ComboBox14.Items.Add(form4.Edit32.Text);
form4.ComboBox14.Items.Add(form4.Edit33.Text);
form4.ComboBox14.Items.Add(form4.Edit34.Text);
form4.ComboBox14.Items.Add(form4.Edit35.Text);
form4.ComboBox14.Items.Add(form4.Edit36.Text);
form4.ComboBox14.Items.Add(form4.Edit37.Text);
form4.ComboBox14.Items.Add(form4.Edit38.Text);
form4.ComboBox14.Items.Add(form4.Edit39.Text);
form4.ComboBox14.Items.Add(form4.Edit40.Text);
form4.ComboBox14.Items.Add(form4.Edit46.Text);
form4.ComboBox14.Items.Add(form4.Edit59.Text);
form4.ComboBox14.Items.Add(form4.Edit60.Text);
form4.ComboBox14.Items.Add(form4.Edit41.Text);
form4.ComboBox14.Items.Add(form4.Edit42.Text);
form4.ComboBox14.Items.Add(form4.Edit43.Text);
form4.ComboBox14.Items.Add(form4.Edit44.Text);
form4.ComboBox14.Items.Add(form4.Edit45.Text);
form4.ComboBox14.Items.Add(inttostr(form4.RadioGroup1.ItemIndex));
form4.ComboBox14.Items.Add(inttostr(form4.RadioGroup2.ItemIndex));


if form4.SaveDialog1.Execute then
form4.ComboBox14.Items.SaveToFile(form4.SaveDialog1.FileName);
end;

end.

